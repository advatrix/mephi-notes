**Опр.** Оптимизация -- достижение наилучшего качества при ограничении на ресурсы.

Качество задаётся в виде формулы $f = f(x_1, \ldots, x_n)$ и зависит от $x_1\ldots x_n$.

Рассмотрим достижение максимума/минимума функции $f$ в случаях:
- $-\infty < x_i < \infty$ (ресурсы не ограничены). Используются экстремумы функций многих переменных
- $\leq x_1\ldots x_n\leq$ (ограничения и критерий задаются нелинейными функциями) -- метод нелинейного программирования. (про это есть учебник Химмельблау)
- $\leq x_1\ldots x_n\leq$ (ограничения и критерий задаются линейными функциями) -- $n$-мерный многогранник, высекаемый $n$-мерными плоскостями. Используется метод линейного программирования

ограничения:
- данные даются с какой-то точностью -- потеря точности при округлении
- потеря точности в ЭВМ
- потеря точности в методе

Число -- безразмерная величина. Понятия числа и величины есть синонимы. Одно и то же число в разных СС выглядит по-разному

СС -- система (математический приём) изображения чисел с помощью ограниченного количества символов

Мы работаем с позиционными СС. Это СС, в которой вклад цифр в величину числа зависит от положения цифры в числе относительно запятой

**Опр**. Пусть $A$ - точное значение числа, $a$ - то приближение, с которым мы будем работать. Тогда величина $\Delta = |A-a| = |a-A|$ называется **абсолютной погрешностью $a$**

**Опр**. $\delta = \frac{\Delta}{|A|}$ называется **относительной погрешностью приближенного числа $a$

Абсолютные и относительные погрешности работают в паре. **Они округляются только в большую сторону**. 

Например, $\Delta = 0.099 = 0.1$ 

Возможны два случая для расчета погрешностей:
- $A$ и $a$ известны (редкий случай). Тогда ранее приведенные формулы для погрешностей являются рабочими. Отсюда находим $\delta$
- $A$ неизвестно (наиболее часто). $a$ известно. Одним из известных способов находят $\Delta$ или $\delta$ и далее полагают, что $$\delta\simeq\frac\Delta a,$$потому что $A\simeq a$. Работая по этой формуле получаем, что $$a-\Delta\leq A\leq a+\Delta$$

Основные источники погрешностей:
- погрешность исходных данных. При обработке они переходят в результат.
- методическая погрешность. Например, значения интегралов можно считать по формулам прямоугольников, трапеций и каких-то умных челов.


## Десятичная запись приближенного числа. Значащие цифры и верные значащие цифры.

Всякое число $A$ может быть представлено в виде бесконечной дроби (**развернутая запись числа)**$$a=\alpha_1\cdot 10^{m-1} +\alpha_2\cdot 10^{m-2}+\ldots +\alpha_{m-1}10^1+\alpha_m10^0+\ldots+\alpha_n 10^{m-n}$$
В этой записи
- $\alpha_i$ -- десятичные цифры числа, $\alpha_i=\overline{0, 9}$
- $n$ -- разрядность числа 
- $m$ -- количество цифр в целой части числа

Например,
$$3141.59=3\cdot10^3+1\cdot10^2_4\cdot10^1+1\cdot10^0+5\cdot10^{-1}+9\cdot10^{-9}$$
Если ввести ограничение на то, что старший разряд не равен нулю:

$$b = \beta_1\cdot 10^{m-1}+\beta_2\cdot10^{m-2}+\ldots+ \beta_n\cdot 10^{m-n}\quad (\beta_1\neq 0)$$

**Опр**. Все сохраняемые десятичные цифры $\beta_i$ ($i = \overline{1, n}$) называются **значащими цифрами**. В числе 0.007010 цифры 7010 -- значащие.

**Опр**. Значащей цифрой приближённого числа называется всякая цифра в его записи, отличная от нуля; ноль, если он содержится между значащими цифрами или представляет сохраняемый десятичный разряд.

Примеры
- 10.89 - 4 зн цифры
- 0.007010 - 4 зн цифры
- 0.00701 - 3

Специальная математическая запись, показывающая количество значащих цифр:

$$689000 = 6.89 \cdot 10^5$$
- $6.89\cdot 10^5$ - 3 зн цифры
- $6.89000\cdot 10^5$ - 6 зн цифр
- $7\cdot 10^5$ - 1 зн цифра

0.000 000 120 
- с тремя зн цифрами $1.20 \cdot 10^{-7}$
- $1.2\cdot 10^{-7}$ с 2 зн цифрами


**Опр.** Говорят, что $n$ первых значащих цифр приближенного числа $a$ являются **верными**, если абсолютная погрешность этого числа не превышает половины единицы младшего $n$-го разряда.

Т. о. если для приближенного числа $a$ с $n$ разрядами, которое заменяет точное число $A$, известно, что 
$$\Delta=|A-a|\leq\frac12\cdot 10^{m-n},$$
то первые $n$ цифр этого числа $\alpha_1,\ldots,\alpha_n$ являются верными.

Например, если для 42.253 $\Delta = 0.004$
- берем младший разряд. проверяем 3 $\frac {10^{-3}}2=0.0005 < \Delta$ => не является верной зн цифрой
- дальше 5 $\frac{10^{-2}}2=0.005>\Delta$ => верно
подчеркнуть цифры и написать: подчеркнутые цифры являются верными

## Округление чисел

Рассмотрим некоторое число $a_{10}$ в десятичной СС. Иногда требуется записать его с меньшим количеством цифр $a\to a_1$ и выбрать $a_1$ так, чтобы погрешность перехода была наименьшей 

$$| a-a_1 | \to\min$$

это достигается соответствующими правилами округления:
- при округлении до $n$ значащих цифр отбрасываются все цифры, стоящие справа от $n$-ой значащей цифры, и если нужно сохранение разрядностей, заменяют их нулями. Два случая
	- если первая из отбрасываемых цифр меньше 5, то оставшиеся десятичные знаки остаются без изменения
	- если она $\geq 5$, то к последней оставляемой цифре добавляют единицу
- погрешность округления при этом не превышает 1/2 единицы последнего оставляемого десятичного разряда

пример
$\pi = 3.1415926535$
если округлить до 3.1416, то $\Delta\leq\frac12 \cdot 10^4$
- 3.142 $\Delta\leq\frac12 \cdot 10^-3$
- 3.14 $\Delta\leq\frac12 \cdot 10^{-2}$

точность приближенного числа зависит не от количества значащих цифр, а от количества **верных** значащих цифр.

## Практическое правило округления при вычислениях

в промежуточных результатах количество значащих цифр должно превосходить количество верных на одну-две цифры. Окончательный результат может содержать  не более, чем одну излишнюю значащую цифру. Это правило позволяет без ущерба для точности избегать написания лишних цифр.

## Общая формула для нахождения погрешностей

**основная задача теории погрешностей**: известны погрешности величин $x1\ldots x_n$, требуется найти погрешность заданной $f(x_1, \ldots, x_n)$ от этих величин

пусть задана дифференцируемая $f = f(x_1\ldots x_n)$ и известны $\Delta x_i$ - абсолютные погрешности агрументов. Тогда абсолютная погрешность функции 

$$\Delta f = |f(x_1 +\Delta x_1, \ldots, x_n + \Delta x_n) - f(x_1, \ldots, x_n)|$$
В силу малости $\Delta x_i$ можно записать так

$$\tag{1}\Delta f = \left| \sum_{i=1}^n\frac{\partial f}{\partial x_i}\Delta x_i\right|$$

$$\tag{2}\Delta f = \sum_{i=1}^n \left|\frac{\partial f}{\partial x_i}\right|\Delta x_i$$

(2) -- **общая формула для расчета погрешностей**

**обратная задача теории погрешностей**: каковы должны быть абсолютные погрешности агрументов функции, чтобы абсолютная погрешность функции не превышала заданной величины?

простейшее решение обратной задачи -- с использованием принципа равных влияний. согласно этому принципу предполагается, что все частные дифференциалы $\left |\frac {\partial f}{\partial x_i}\right |\Delta x_i$ вносят одинаковый вклад в абсолютную погрешность $\Delta f$ 

пусть $\Delta f$ задана, тогда 

$$\Delta f = \sum_{i=1}^n \left|\frac{\partial f}{\partial x_i}\right|\Delta x_i$$
$$\left|\frac{\partial f}{\partial x_1}\right|\Delta x_1=\left|\frac{\partial f}{\partial x_2}\right|\Delta x_2=\ldots=\left|\frac{\partial f}{\partial x_n}\right|\Delta x_n=\frac{\Delta f} f$$
$$\Delta x_i = \frac{\Delta f}{n\cdot \left|\frac{\partial f}{\partial x_i}\right|}$$

Формула (2) является приближенной, потому что там используются частные производные. Но если надо найти диапазон изменения функции в заданной точке, используется **метод границ** или и **метод двойных вычислений**, где, зная погрешности аргументов, можно точно указать диапазон изменения ф-ии

## Метод границ или метод двойных вычислений

Пусть $f(x_1, \ldots, x_n)$ непрерывна и монотонна по каждому аргументу. При этом сами аргументы находятся в диапазоне $x_{i_\min}\leq x_i\leq x_{i_\max}$

Тогда

$$ f(\underline x_1, \ldots, \underline x_n)\leq f\leq f(\overline x_1, \ldots, \overline x_n)$$

Слева - границы интервалов, где значения функции минимальны. Справа - границы интервалов, в которых функция максимальна. 

$$\Delta f_1 = \left|f(\overline x_1, \ldots, \overline x_n) - f(x_1, \ldots, x_n)\right|$$

$$\Delta f_2 = \left|f(x_1, \ldots, x_n) - f(\underline x_1, \ldots, \underline x_n)\right|$$
$$ f_0-\Delta f_2\leq f\leq f_0 + \Delta f_1$$
$$f = f_0\quad \begin{matrix}  + \Delta f_1; \quad \delta_1 = \frac{\Delta f_1}{f_0} \\ - \Delta f_2; \quad \delta_2 = \frac{\Delta f_2}{f_0}\end{matrix}$$

$$f = f_0\pm \Delta f;\quad \delta_1; \quad\text{if } \Delta f_1 = \Delta f_2$$

Здесь $f_0$ – значение функции в точке.

### Взаимосвязь относительных погрешностей приближенного числа с количеством верных цифр в записи числа 

Пусть дано $a = \alpha\cdot 10^{m-1}+\alpha_2\cdot 10^{m-2} + \ldots +\alpha_n \cdot 10^{m-n}\quad (\alpha_1\neq 0)$
Это число во всеми верными цифрами.

**Теорема**.. Если некоторое число $a$ имеет $n$ верных цифр, относительная погрешность этого числа $\delta$ не превышает величины

$$\delta\leq \frac 1{\alpha_1}\left(\frac 1{10}\right)^{n-1}$$

**Следствие 1**. За относительную погрешность числа $a$ можно принять величину, если в $a$ $n$ верных цифр.

$$\delta = \frac 1{\alpha_1}\left(\frac 1{10}\right)^{n-1}$$
**Следствие 2**. Если в записи числа 2 и больше верных цифр, то за относительную погрешность можно принять в 2 раза точнее

$$\delta = \frac 1{2\alpha_1}\left(\frac 1{10}\right)^{n-1}$$
В ДЗ можно аргументировать так: берём это приближение и эта величина должна быть ≤ заданного $\delta$, оттуда находим $n$.

### Полезная информация

| Количество верных цифр  |   Относительная погрешность  | Средняя величина    |
| --- | --- | --- |
|  1   | 5 - 50%    |   10%  |
|   2  |  0.5 - 5%   |  1%   |
|    3 | 0.05 - 0.5%    |  0.1%   |

## Правило определения верных значащих цифр в записи числа по абсолютной погрешности числа (по определению)

3 шага:
1. Берем 1, проверяем в разряде.
2. Делим её пополам
3. Сравниваем результат деления с абсолютной погрешностью. Если погрешности ≤ результату деления, то цифра в этом разряде является верной.

## Правило определения верных значащих цифр числа по заданной относительной погрешности

2 шага:
1. По формуле $\Delta = a\cdot \delta$ определяется величина абсолютной погрешности $\Delta$.
2. Применяется предыдущее правило для определения верных цифр числа по заданной абсолютной погрешности.

### Пример

результат = 25.4275 $\pm$ 0.0424

пишем с меньшим количеством цифр:
результат = 25.428 $\pm$ 0.043 (погрешность всегда округляется в большую сторону)

еще меньше цифр 
рез = 25.43 $\pm$ 0.05

---
$\Delta = 0.21$ округлить до одной значащей цифры → $\Delta = 0.3$

## Эмпирические формулы

Пусть выполнен эксперимент. Получен ряд значений $x_1\ldots x_n$ и $y_1\ldots y_n$.

Требуется найти эмпирическую формулу $y = f(x)$.

Построение этой формулы состоит из двух этапов.
1. Определение общего вида формулы (экспонента, степень, гипербола и тд)
2. Определение наилучших параметров формулы

Это **не задача интерполяции:** 
- Интерполяционный полином проходит точно по точкам, а эмпирическая формула – рядом с ними.
- эмпирическая формула, как правило, более проста
- она сглаживает местные погрешности; интерполяционный полином их, наоборот, собирает

### Замечание

При построении эмпирической формулы будем предполагать, что исходные данные эксперимента $x_i$ и $y_i$ положительны.

Но это не нарушает общность решения задачи:
- если $x_i < 0, y \geq 0$, мы можем уйти на работу с таблицей $(-x_i; y_i)$
- если наоборот, то работаем с $(x_i; -y_i)$
- если $x_i<0, y_i < 0$, то работаем с $(-x_i; y_i)$
- если они знакопеременны, то переходим к новым переменным
	- $\xi_i = m + x_i > 0$
	- $\eta_i = n + y_i > 0$ 
	- выбираем $m$ и $n$ в силу ограниченности таблицы
	- работаем с таблицей $(\xi_i, \eta_i)$

### Линейная зависимость

$$\begin{array}{c|c} x_i & x_1 & x_2 & x_3 & x_4 & \ldots \\\ y_i & y_1 & y_2 & y_3 & y_4 & \ldots\end{array}$$

Пусть мы считаем, что зависимость линейная (это наша гипотеза, и её надо проверить). Для этого эта таблица дополняется значениями 

$$\Delta x_i = x_{i+1} - x_i$$
$$\Delta y_i = y_{i+1} - y_i$$

$$\frac{\Delta x_i}{\Delta y_i}$$

Получаем

$$\begin{array}{c|c} x_i & x_1 & x_2 & x_3 & x_4 & \ldots \\\ y_i & y_1 & y_2 & y_3 & y_4 & \ldots\\\ \Delta x_i = x_{i+1} - x_i & \Delta x_1&\ldots\\\ \Delta y_i = y_{i+1} - y_i&\Delta y_1\\\ k_i = \frac{\Delta x_i}{\Delta y_i}&\frac{\Delta x_1}{\Delta y_2}\end{array}$$

Если оказывается, что $k_1\simeq k_2\simeq \ldots\simeq k_{n-1}$, то зависимость имеет линейный вид $y = kx + b$.

Если эксперимент выполнялся с постоянным шагом ($\Delta x_i = \text{const}$ ) то достаточно проверить $\Delta y_1 = \ldots = \Delta y_{n-1}$

### Степенная зависимость

Пусть гипотеза, такая, что $y = cx^a$, где
- $a, c$ – константы
- $c > 0$ (из предположения о том, что всё положительное)
- $x, y > 0$

логарифмируем:
$$y = cx^a$$

$$\lg y = a \lg x + \lg c$$

вводим новые переменные:

$$X = lg x\quad Y = \lg y$$
у новых переменных зависимость такая
$$Y = aX + b, \quad b = \lg c$$
мы пришли к тому, что чтобы исходная зависимость была степенная, надо, чтобы точки $N_i(\lg x_i, \lg y_i)$ лежали на одной прямой:

$$N = (\lg x_i, \lg y_i)$$

В соответствии с этим дополняем таблицу

$$\begin{array}{c|c} x_i & x_1 & x_2 & x_3 & x_4 & \ldots \\\ y_i & y_1 & y_2 & y_3 & y_4 & \ldots\\\ X = \lg x&\lg x_1\\\ Y = \lg y&\lg y_1\\\ \Delta X = \lg x_{i+1} - \lg x_i&\lg x_2 - \lg x_1\\\ \Delta Y = \lg y_{i+1} - \lg y_i \\\ \frac{\Delta Y}{\Delta X}\end{array}$$

Если $\frac{\Delta Y}{\Delta X}=\text{const}$, то исходная зависимость имеет вид $y = cx^a$.


### Показательная зависимость

Гипотеза: $y = ce^{ax}, \quad c>0$

Логарифмируем

$$\lg y = a_1 x + \lg c, \quad a_1 = a\lg e$$

вводим новые переменные

$$ X = x\quad Y = \lg y$$

в новых переменных зависимость принимает вид

$$ Y = a_1 X + b, \quad b = \lg c$$

чтобы исходная зависимость была показательная, нужно, чтобы точки $N_i(x_i, \lg y_i)$ лежали на одной прямой (это уже где-то было -_-)

дополняем таблицу

$$\begin{array}{c|c} x_i & x_1 & x_2 & x_3 & x_4 & \ldots \\\ y_i & y_1 & y_2 & y_3 & y_4 & \ldots\\\ Y = \lg y&\lg y_1\\\ \Delta X \\\ \Delta Y = \lg y_{i+1} - \lg y_i \\\ \frac{\Delta Y}{\Delta X}\end{array}$$

если $\frac {\Delta Y}{\Delta X} = \text{const}$, то это показательная зависимость

### Гиперболическая зависимость

гипотеза 

$$ y =\frac 1{ax + b}$$

$$ \frac 1y = ax + b$$

вводим новые переменные

$$ X = x\quad Y = \frac 1y$$

в них зависимость такая

$$ Y = aX + b$$

чтобы исходная зависимость была гиперболическая, нужно, чтобы точки $N_i(x_i, \frac 1{y_i})$ лежали на одной прямой

дополняем таблицу по аналогии с кейсами выше

$$\begin{array}{c|c} x_i & x_1 & x_2 & x_3 & x_4 & \ldots \\\ y_i & y_1 & y_2 & y_3 & y_4 & \ldots\\\ Y = \frac 1y&\frac 1{y_1}\\\ \Delta X \\\ \Delta Y \\\ \frac{\Delta Y}{\Delta X}\end{array}$$

если $\frac {\Delta Y}{\Delta X} \simeq \text{const}$, то это гиперболическая зависимость

### Квадратичная (параболическая) зависимость

гипотеза $y = ax^2 + bx + c\quad (a\neq 0)$

$$\tag 1 y = ax^2 + bx + c$$
- переносим эксперимент на плоскость (рисуем точки на графике)
- проводим плавную кривую $\Gamma$ вблизи экспериментальных точек и выбираем на этой кривой одну из точек $N(x_0, y_0)$, которая совпадает с некоторой экспериментальной точкой $M(x_k, y_k)$
- координаты этой точки будут удовлетворять параболе
$$\tag 2 y_0 = ax_0^2 + bx_0 + c$$

- вычитаем (1) - (2)

$$y - y_0 = a(x^2 - x_0^2)+b(x-x_0)$$
- дополняем до полного квадрата при $a$

$$y - y_0 = a(x - x_0)^2 + b_1(x - x_0), \quad b_1 = b + 2ax_0$$

- вводим новые переменные

$$X = x - x_0\quad Y = \frac{y - y_0}{x - x_0}$$

- тогда получаем зависимость

$$ Y = aX + b_1$$

если точки $N_i = (X_i, Y_i), X_i = x_i - x_0; Y_i = \frac{y_i - y_0}{x_i - x_0}$ лежат на одной прямой, то исходные точки лежат на параболе


## Определение параметров эмпирической формулы

если выбран общий вид формулы $y = \overline f(x; a_1, \ldots, a_m)$, то следующим шагом является нахождение наилучших параметров $a_i$

есть три метода для этого
- метод выбранных точек
- метод средних
- метод наименьших квадратов

В БДЗ можно пользоваться любым методом

**Формулировка задачи**. Пусть дана система значений $M_i(x_i, y_i)$ – эксперимент (n точек). Она приближенно описывается формулой вида $y = \tilde f (x, a_1, \ldots, a_m)$, где $\tilde f$ – это известная функция, $a_i$ – некоторые постоянные (параметры) (m < n).

Нас интересуют величины параметров.

У нас имеются экспериментальные точки 

$$
\begin{cases}y_i = \tilde f(x_i, a_1, \ldots, a_m) + \varepsilon_i
\\\
i = 1, \ldots, n
\end{cases}
$$

$\varepsilon$ – это отклонения реальных точек от приближенного графика. Они называются **уклонения**.

У нас n уравнений, а неизвестных n + m. (эпсилоны и параметры).

Надо найти именно *наилучшие* параметры:

$$
y_i = f(x, \tilde a_1, \ldots, \tilde a_m) = \varepsilon_{i_\min}
$$

Геометрическая интерпретация: проведение графика функции так, чтобы он наиболее близко прилегал к экспериментальным точкам.

### Метод выбранных точек

Пусть для системы $M_i(x_i, y_i)$ из n точек построена общая формула $y = \tilde f (x, a_1, \ldots, a_m)$, m < n. $\tilde f$ известна.

Решение:

1. На координатную плоскость переносим точки эксперимента
2. На этой плоскости Oxy с наибольшей аккуратностью проводим кривую Г, чтобы она как можно ближе прилегала к этим точкам
3. На этой кривой выбираем систему из m точек по числу неизвестных параметров – $N_j(\tilde x_j, \tilde y_j), j=1\ldots m$.  Эти точки не обязательно должны совпадать с точками эксперимента

#### Требования к размещению точек $N_j$

1. Точки $N_j$ должны равномерно распределяться по всей рабочей части кривой Г.
2. Они должны как можно дальше отстоять друг от друга
3. Они не должны располагаться близко к малонадежным концевым точкам, то есть точкам $M_1$ и $M_n$

После этого со всей тщательностью замеряют координаты этих точек.

Тогда искомые параметры $a_1\ldots a_m$ могут быть определены из системы следующих уравнений

$$
\begin{cases}
\tilde y_j = \tilde f(\tilde x_j, a_1, \ldots, a_m)
\\\
j = 1, \ldots, m
\end{cases}
$$

То есть у нас m неизвестных и m уравнений.

#### Примеры применения метода для линейной зависимости

- $y = ax + b$
- надо найти параметры a, b
- переносим эксперимент на координатную плоскость
- строим кривую Г
- берем 2 точки $(\tilde x_1, \tilde y_1), (\tilde x_2, \tilde y_2)$ и записываем систему

$$
\begin{cases}
\tilde y_1 = a\tilde x_1 + b
\\\
\tilde y_2 = a\tilde x_2 +b
\end{cases}
$$

#### Примеры применения метода для квадратичной зависимости

- $y =ax^2 + bx + c$
- плоскость
- рисуем параболу Г
- три параметра => берем три точки, $(x_1, y_1), (x_2, y_2), (x_3, y_3)$


$$
\begin{cases}
\tilde y_1 = a\tilde x_1^2 + b\tilde x_1 + c
\\\
\tilde y_2 = a\tilde x_2^2 +b\tilde x_2 + c
\\\
\tilde y_3 = a\tilde x_3^2 +b\tilde x_3 + c
\end{cases}
$$

Это система из 3 линейных уравнений из 3 неизвестными, потому что иксы известны.

#### Преимущества и недостатки

Метод выбранных точек содержит геометрические построения, поэтому он является грубым. 

Достоинства: простота применения и наглядность.

К этому методу следует прибегать в тех случаях, когда точность исходных данных относительно невелика.

### Метод средних

Если в формулу $y = \tilde f(x, a_1, \ldots, a_m)$ подставить исходные данные $M_i(x_i, y_i)$, то в общем случае левая часть не будет равна правой

$$
\tilde f(x_i, a_1, \ldots, a_m) - y_i = \varepsilon_i
$$

Эпсилоны это расстояние по вертикали от функции до точек.

Суть метода: наилучшее расположение эмпирической кривой это когда $\displaystyle \sum_{i=1}^n \varepsilon_i = 0$.

1. Записывается система из n уравнений (по числу эмпирических точек)

$$
\begin{cases}
\tilde f(x_i, a_1, \ldots, a_m) - y_i = \varepsilon_i
\\\
i = 1, \ldots, n
\end{cases}
$$

2. Уравнения разбиваются на m групп (по числу неизвестных параметров)
3. Уравнения суммируются в группах
4. Решается система из m уравнений с m неизвестными $a_1, \ldots, a_m$. Причем суммы уравнений в группах приравниваются к нулю.


#### Пример применения метода средних

экспериментальные точки


| t   | 7    | 12   | 17   | 22   | 27   | 32   | 37   |
| --- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| Q   | 83.7 | 72.9 | 63.2 | 54.7 | 47.5 | 41.4 | 36.3 |



это парабола, гипотеза $Q = at^2 + bt + c$


Составляем 7 уравнений (по 7 точкам) и разбиваем на 3 группы

$$
\begin{array}{}
\begin{cases}
\varepsilon_1 = 49a + 7b + c - 83.7
\\\
\varepsilon_2 = 144a + 12b + c - 72.9
\\\
\varepsilon_3 = 289a + 17b + c - 63.2
\end{cases}
\\\
\begin{cases}
\varepsilon_4 = 484a + 22b + c - 54.7
\\\
\varepsilon_5 = 729a + 27b + c - 47.5
\end{cases}
\\\
\begin{cases}
\varepsilon_6 = 1024a + 32b + c - 41.4
\\\
\varepsilon_7 = 1369a + 37b + c - 36.3
\end{cases}
\end{array}
$$

Суммируем уравнения в группах

$$
\begin{cases}
482a + 36b + 3c - 219.8 = \varepsilon_1 + \varepsilon_2 + \varepsilon_3 = 0
\\\
1213a + 49 b + 2c - 102.2 = \varepsilon_4 + \varepsilon_5 = 0
\\\
2393a + 69 b + 2c - 77.7 = \varepsilon_6 + \varepsilon_7 = 0
\end{cases}
$$


Получается система из 3 уравнений. Решаем ее и получаем

$$
a = 0.0235, b = -2.6115, c = 100.8295
$$

Получаем такую эмпирическую формулу

$$
\tilde Q = 0.00235 t^2 - 2.6115 t + 100.8295
$$

Результаты метода средних **существенно** зависят от способа группировки отклонений. Практика показывает, что наиболее удачные эмпирические формулы получаются, если уклонения группируются в порядке последовательности их номеров, и каждая группа содержит, по возможности, одинаковое количество членов.

### Метод наименьших квадратов

Пусть известен вид эмпирической формулы  $y = \tilde f(x, a_1, \ldots, a_m)$ . Уклонения $\varepsilon_i = \tilde f(x_i, a_1, \ldots, a_m) - y_i$, $i = 1, \ldots n$/

Согласно МНК наилучшими величинами параметров $a_1, \ldots, a_m$ считаются те, для которых сумма квадратов отклонений минимальна

$$
\sum_{i=1}^n \varepsilon_i^2 =[\tilde f(x_i, a_1, \ldots, a_m) - y_i]^2 = S(a_1, \ldots, a_m)
$$

То есть это получается функция S от параметров. Далее, применяя необходимые условия экстремума функции многих переменных, получаем систему уравнений для определения параметров $a_j, j = 1, \ldots, m$.

$$
\begin{cases}
\frac{\partial S}{\partial a_1} = 0
\\\
\ldots
\\\
\frac{\partial S}{\partial a_m} = 0
\end{cases}
$$

Если система имеет единственное решение, то оно и будет искомым. 

МНК отличается тем преимуществом, что если сумма $S$ квадратов отклонений $\varepsilon_i$ мала, то сами эти уклонения также малы по абсолютной величине. Для метода средних, где оставляется алгебраическая сумма отклонений, такого вывода сделать нельзя (большие отклонения могут компенсировать друг друга).

Недостаток метода: сложность вычислений. К этому методу обычно прибегают при обработке наблюдений высокой точности.

# Интерполяция

Пусть для некоторой функции $y(x)$ известно, что при $x_0$ она принимает значение $y_0 = y(x_0)$ и так далее

Нам известны n эмпирических значений $y_i = y(x_i)$. Строить эмпирическую формулу мы не хотим, но хотим с этой функцией работать. Тогда прибегают к интерполяции: исходную функцию приближенно заменяется другой функцией $y(x)\simeq P(x)$, которую называют **интерполяционным полиномом**, такую, что

$$
P(x_0) = y_0\quad\ldots\quad P(x_n) = y_n
$$

то есть этот полином вьётся через экспериментальные точки. 

При этом $x\in [x_0, x_n]$.

**Замечание**. Если мы работаем с $x < x_0; x > x_n$ – то есть построили интерполяционный полином, но стали работать за его краями, то замена функции будет называться **экстраполяцией**

**Замечание**. Интерполяция и экстраполяция – частные случаи **аппроксимации**.

Для записи интерполяционных многочленов существует достаточно большое количество формул. Например, известны интерполяционные формулы Лагранжа, Ньютона, Гаусса, Бесселя, Стирлинга, Грегори-Ньютона, Лапласа-Эверетта и другие.  

Мы рассмотрим первые две формулы. Формулу Лагранжа трудно забыть ~~и легко потерять~~, а формула Ньютона наиболее удобна для расчетов вручную и на ЭВМ.

## Интерполяционная формула Лагранжа

Пусть имеются значения аргумента $x_0, \ldots, x_n$. – всего n+1 значение с некоторым шагом и значения $y_0 \ldots y_n$. Тогда интерполяционная формула Лагранжа имеет следующий вид

$$
P_n(x)_{\text{Лагр}} = 
\begin{array}{}
\frac{(x-x_1)(x-x_2)\dots (x-x_n)}{(x_0-x_1)(x_0-x_2)\dots (x_0-x_n)} y_0&+& x = x_0; P(x_0 ) = y_0
\\\
\frac{(x-x_0)(x-x_2)\dots (x-x_n)}{(x_1-x_0)(x_1-x_2)\dots (x_1-x_n)}y_1 &+ & x = x_1; P(x_1 ) = y_1
\\\
\ldots
\\\
\frac{(x-x_0)(x-x_1)\dots (x-x_{n-1})}{(x_n-x_0)(x_n-x_1)\dots (x_n-x_{n-1})}y_n & & x = x_n; P(x_n ) = y_n
\end{array}
$$

## Формула Ньютона

БДЗ будем делать по этой формуле. Будут даны точки, и будем считать интерполяцию в двух точках вперед и назад.

Наиболее удобной для вычислений на ЭВМ и вручную является формула Ньютона. Имеется n+1 точка $(x_i, y_i)$, и шаг переменный.

При переменном шаге применяются разделенные разности. Они определяются при помощи следующих соотношений.

- Разделенная разность первого порядка – это число $y(x_0, x_1) = [y(x_1) - y(x_0)] / (x_1 - x_0)$
- Разделенная разность второго порядка – это число $y(x_0, x_1, x_2) = [y(x_1, x_2) - y(x_0, x_1)] / (x_2 - x_0)$. То есть используются разделенные разности первого порядка и делятся на длину всего отрезка
- Разделенная разность третьего порядка $y(x_0, x_1, x_2, x_3) = [y(x_1, x_2, x_3) - y(x_0, x_1, x_2)] / (x_3 - x_0)$
- и так далее

Разделенные разности первого, второго и более высоких порядков имеют размерности производных соответствующих порядков. Они дают приближенные значения этих производных в соответствующих точках. Мы записали эти значения для точки $x_0$.

На отрезке $[x_0, x_n]$ интерполяционная формула Ньютона имеет следующий вид

$$
y(x) \simeq P_n(x)_{\text{Ньют}} = y(x_0)+(x-x_0)y(x_0, x_1)+(x-x_0)(x-x_1)y(x_0, x_1, x_2)+\ldots +(x-x_0)(x-x_1)\cdots (x-x_{n-1})y(x_0, x_1, \ldots, x_n)
$$

$$
= y(x_0)+\sum_{k=1}^n(x-x_0)(x-x_1)\cdots (x-x_{k-1})\cdot y(x_0, x_1, \ldots, x_k)
$$

### Таблица разделенных разностей табулированной функции $y = f(x)$ для проведения вычислений


| x0  | y(x0) | y(x0, x1)  = (y(x0)-y(x1))(x1-x0) |                                             |                                                       |
| --- | ----- | --------------------------------- | ------------------------------------------- | ----------------------------------------------------- |
| x1  | y(x1) | y(x1, x2)                         | y(x0, x1, x2) = (y(x1,x2)-y(x0,x1))/(x2-x0) | y(x0, x1, x2, x3) = (y(x1,x2,x3)-y(x0,x1,x2))/(x3-x0) |
| x2  | y(x2) | y(x2, x3)                         | y(x1, x2, x3)                               |                                                       |
| x3  | y(x3) |                                   |                                             |                                                       |

За точностью расчетов при применении формулы Ньютона удобно следить визуально: оценивают скорость убывания составляющих суммы, оставляют те составляющие, которые больше допустимой погрешности (абсолютной).

### Пример

Пусть дана функция синуса в первом квадранте $y(x) = \sin (30 \degree \cdot x), 0\leq x \leq 3$. Вычислить функцию при $x =1.5$, применяя 4 известных значения.

$y(1.5) = \sin(30\degree \cdot x)=\frac{\sqrt2}2$

Составляем таблицу

| xi  | y(xi)  | y(xi, xi-1) |               y(xi, xi+1, xi+2)                              |              y(xi, xi+1, xi+2, xi+3)                                         |
| --- | ------ | --------------------------------- | ------------------------------------------- | ----------------------------------------------------- |
| 0   | 0.0000 |                        0.500           |                                             |                                                       |
| 1    |     0.5000   |                      0.366             |      -0.067                                       |           -0.016                                            |
|  2   |     0.8666   |                           0.134        |            -0.116                                 |                                                       |
|   3  |   1.000     |                                   |                                             |                                                       |

$$
y(x) = y(x_0)+(x-x_0)y(x_0, x_1)+(x-x_0)(x-x_1)y(x_0, x_1, x_2)+(x-x_0)(x-x_1)(x-x_2)y(x_0, x_1, x_2, x_3)
$$

$$
y(1.5) = 0+1.5\cdot 0.500+1.5\cdot 0.5\cdot (-0.067)+1.5\cdot0.5\cdot(-0.5)\cdot(-0.016)=0+0.0750-0.050+0.006=0.706
$$

(Точное значение 0.707)

---
Однако на практике бывает, что шаг интерполяции постоянный. Здесь формула Ньютона принимает несколько другой вид – с конечными разностями.

$$
n! y(x_0, x_1, \ldots, x_n)\cdot n!=\Delta^n y
$$

Удобство при расчетах с конечными и разделенными разностями одинаково

## Интерполяционная формула Ньютона для равноотстоящих значений аргументов

$h = x-{i+1} - x_i = const (i=0, 1, \ldots, n)$

Пусть $y_k = y(x_i)$, где $x_k$ – это узлы интерполяции, $x_k = x_0+kh (k=0, 1, 2, \ldots)$. Вводится такая величина $q$:

$$
\frac{x-x_0}h = q
$$

Сама формула принимает следующий вид.

Пусть заданы значения $y_0, \ldots, y_n$. Это интерполяция вперёд ($y_0$ слева, $y_n$ справа) – то есть интерполяционный процесс развивается слева направо. 

Но начальное значение может задаваться справа. В этом случае при движении справа налево у нас будет $y_0, y_{-1}, \ldots, y_{-n}$. Это интерполяция назад, процесс интерполяции развивается справа налево от начального узла.

Формула Ньютона для интерполяции вперёд и назад имеет следующий вид

$$
y(x) = y_0+\frac {q\cdot \Delta y_0}{1!}+\frac{q(q-1)}{2!}\cdot \Delta^2 y_0+ \frac {q(q-1)(q-2)}{3!}\Delta^2y_0+\ldots,
$$

где 

$$
q = \frac{x-x_0}h;\quad h = x_{i+1}-x_i\quad (i=0, 1, \ldots)
$$

В этой формуле $\Delta y_0, \Delta^2y_0, \ldots$ – конечные разности различных порядков.

### Формула Ньютона в конечных разностях (шаг постоянный). Интерполяция вперед

На примере

$$
y = \sin(30\degree \cdot x), \quad x = 1.5;\quad \sin 45\degree  = \sin(30\degree\cdot1.5)
$$

(это уже где-то было, но теперь будет в конченых разностях – просто последующий минус предыдущий)

| xi  | y(xi)  | delta yi | delta2 yi | delta3 yi |
| --- | ------ | -------- | --------- | --------- |
| 0   | 0.0000 | 0.500    |           |           |
| 1   | 0.5000 | 0.366    | -0.134    | -0.098    |
| 2   | 0.8666 | 0.134    | -0.232    |           |
| 3   | 1.000  |          |           |           |


$h= 1;\quad q = \frac{1.5-0.000}1 = 1.5$

$$
y(1.5) = 0+1.5\cdot 0.500+\frac{1.5\cdot0.5}2\cdot(-0.134)+\frac{1.5\cdot0.5\cdot(-0.5)}{3!}\cdot(-0.098)=0.706
$$

Получилась такая же точность.

### Формула Ньютона в конечных разностях (шаг постоянный). Интерполяция назад

задача такая же

$$
y = \sin(30\degree \cdot x), \quad x = 1.5;\quad \sin 45\degree  = \sin(30\degree\cdot1.5)
$$

применяем интерполяцию назад, то есть начальный узел будет справа, $y_0=1$

| xi  | y(xi)  | delta yi | delta2 yi | delta3 yi |
| --- | ------ | -------- | --------- | --------- |
| 3   | 1.0000 | -0.134   |           |           |
| 2   | 0.866  | -0.366   | -0.232    | 0.098     |
| 1   | 0.500  | -0.500   | -0.134    |           |
| 0   | 0.000  |          |           |           |

$q = \frac{1.5 - 3}{-1} = +1.5$

подставляем данные из таблицы в формулу

$$
y(x) = y_0+\frac {q\cdot \Delta y_0}{1!}+\frac{q(q-1)}{2!}\cdot \Delta^2 y_0+ \frac {q(q-1)(q-2)}{3!}\Delta^2y_0+\ldots,
$$

$$
y(1.5) = 1.000+1.5\cdot(-0.134)+\frac{1.5\cdot0.5}2\cdot(-0.232)+\frac{1.5\cdot0.5\cdot(-0.5)}{3!}\cdot0.098=0.706
$$

## Замечания по теме интерполяции

1. При построении интерполяционной формулы Ньютона в качестве начального узла интерполяции $x_0$ выбирается первый или последний узел интерполяции.
2. При увеличении количества узлов интерполяции или при уменьшении шага интерполяции интерполяционный полином сходится к функции $y(x)$, которую он заменяет.
3. На практике применять интерполяционные многочлены высокой степени нежелательно. Если 3-5 узлов не обеспечивают заданной точности, то надо не увеличивать количество узлов, а уменьшать шаг интерполяции.
4. В интерполяционных формулах оставляют только те составляющие, которые по абсолютной величине больше исходно заданной абсолютной погрешности.

В БДЗ это 7 пункт. Вычислить значение функции в двух заданных точках. Можно использовать и конечные, и разделенные разности


# Численное интегрирование

Пусть $f(x)$ – некоторая непрерывная функция, заданная на отрезке $[a, b]$. Надо вычислить $\int\limits_a^b f(x)dx$.

Точное значение интеграла

$$
\int\limits_a^b f(x)dx = F(b)-F(a)
$$

Возможны такие случаи
1. Первообразная $F(x)$ неизвестна
2. $F(x)$ известна, но слишком сложна
3. Подынтегральная функция $f(x)$ задана таблично
В этих случаях для вычисления интеграла $\int\limits_a^b f(x)dx$ применяют численные методы. Численных методов для вычисления определенных интегралов достаточно много. Но в подавляющем большинстве этих случаев эти методы применяют общий подход.

## Общий подход

Функция $f(x)$ на отрезке $[a, b]$ заменяется аппроксимирующей функцией: $f(x)\simeq \varphi(x)$, а затем приближенно полагают:

$$
\int\limits_a^bf(x)dx\approx\int\limits_a^b\varphi(x)dx
$$

При этом $\varphi(x)$ – такая функция, от которой интеграл берется непосредственно (то есть легко)

## Формула трапеции

Пусть $y = f(x)$ на отрезке $[x_0, x_1]$. Интересует интеграл $\int\limits_{x_0}^{x_1}ydx$

$f(x)$ заменяется секущей функцией $\varphi(x)$. Точное значение интеграла равняется площадью фигуры под графиком, и мы эту площадь заменяем площадью получающейся трапеции.

$$
\int\limits_{x_0}^{x_1}ydx\approx \frac h2(y_0+y_2)
$$

где $h = x_1 - x_0$ – высота трапеции

Погрешность $R$ такая:

$$
R = \int\limits_{x_0}^{x_1}ydx - \frac h2(y_0+y_2) = -\frac{h^3}{12}y''(\xi), \quad \xi\in(x_0, x_1)
$$

$\xi$ – это некоторая точка на интервале.

### Общая формула трапеции (правило трапеции)

Интересует значение интеграла $\int\limits_a^bydx$. $y = f(x)$ непрерывна на $[a, b]$.

Отрезок $[a, b]$ делится на $n$ равных частей. Получаем отрезки $[x_0, x_1], \ldots, [x_{n-1}, x-n]$. К каждому из этих отрезков применяем формулу трапеции. Полагая, что величина одного отрезка равна $h=\frac{b-a}n$ и обозначая $y_i = f(x_i)$ – значение функции в узлах, получаем

$$
\tag{2}\int\limits_a^b ydx \approx \frac h2(y_0+y_1)+\ldots+\frac h2(y_{n-1+y_n})=h\left(\frac {y_0}2+y_1+\ldots+y_{n-1}+\frac{y_n}2\right)
$$

$$
=\frac{b-a}{2n}\left[y_0+2y_1+2y_2+\ldots+2y_{n-2}+2y_{n-1}+y_n\right]=
$$

$$
\frac h2\sum_{i=0}^n c_i\cdot y(x_i), \quad c_o = c_n = 1;c_i = 2 (i = 2, \ldots, n-1)
$$

Получается три формы записи одной и той же формулы. В БДЗ будем делать по последней.

Погрешность этой формулы следующая

$$
R = \int\limits_a^b ydx - \frac h2 \sum_{i=1}^n(y_{i-1}+y_i) = \sum_{i=1}^n\left[\int\limits_{x_{i-1}}^{x_i}ydx - \frac h2(y_{i-1}+y_i)\right] = \sum_{i=1}^n -\frac{h^3}{12}y''(\xi_i)=-\frac{h^3}{12}\sum_{i=1}^n y''(x_i), \quad \xi_i\in(x_{i-1}, x_i)
$$

применяем теорему о средних

$$
R = -\frac{h^3}{12}\cdot n\cdot y''(\xi) = -\frac{(b-a)h^2}{12}y''(\xi), \quad \xi\in[a, b]
$$

Если нам нужно, чтобы погрешность $R$ была не больше заданной погрешности $\Delta$, делаем так:

$$
M_2 = \max_{[a, b]}y''(x)
$$

$$
\frac{(b-a)\cdot h^2}{12}\cdot M_2\leq\Delta
$$

Отсюда находим оптимальный шаг:

$$
h\leq\sqrt{\frac{12\Delta}{M_2(b-a)}}
$$

## Формула средних

Элементарный отрезок $[x_0, x_1]$, на котором непрерывна $f(x)$

ищем $\int\limits_{x_0}^{x_1}y dx$

берется средняя точка на отрезке $\tilde x$, и площадь под графиком функции заменяется площадью прямоугольника

$$
\int\limits_{x_0}^{x_1}ydx\approx h\cdot f(\tilde x), \quad \tilde x =  \frac{x_0+x_1}2
$$

погрешность $R$ метода на элементарном отрезке следующая

$$
R = \int\limits_{x_0}^{x_1}ydx - h\cdot f\left(\frac{x_0+x_1}{2}\right)\simeq \frac{1}{24}(x_1-x_0)^3f''(\tilde x)=\frac{h^3}{24}f''(\tilde x)
$$

### Общая формула средних

отрезок [a, b] делится на n равных частей, получаем n равных отрезков $[x_{i-1}, x_i]$. На этих отрезках пишем формулу средних

$$
\int\limits_{x_0}^{x_1}ydx\approx\sum_{i=1}^n (x_i-x_{i-1})\cdot f\left(\frac{x_i+x_{i-1}}{2}\right)
$$

$$
R = \int\limits_{x_0}^{x_1}ydx-\sum_{i=1}^n (x_i-x_{i-1})\cdot f\left(\frac{x_i+x_{i-1}}{2}\right)=\sum_{i=1}^n\left[\int\limits_{x_{i-1}}^{x_i}ydx-(x_i-x_{i-1})\cdot f\left(\frac{x_i+x_{i-1}}{2}\right)\right]\simeq \sum_{i=1}^n \frac{h^3}{24}\cdot f''(\tilde x_i) = \frac 1{24}\cdot n\cdot h^3 f''(\xi)=\frac{(b-a)h^2}{24}f''(\xi), \quad \xi\in[a, b]
$$

погрешность в 2 раза меньше чем у метода трапеции

если надо получить погрешность меньше заданной:

$$
M_2 = \max_{[a, b]}y''(x)
$$

$$
\frac{(b-a)h^2}{24}M_2\leq \Delta
$$

откуда находим оптимальный шаг

$$
h\leq\sqrt{\frac{24\Delta}{M_2(b-a)}}
$$
## Формула Симпсона (параболическая формула)

обладает высокой точностью

функция задана на двойном отрезке $[x_0, x_2]$

нас интересует интеграл на $[x_0, x_2]$

середина отрезка – $x_1$, шаг между иксами $h$. Известно три точки

идея метода: точки $M_0 (x_0, y_0), M_1(x_1, y_1), M_2(x_2, y_2)$ известны. Через эти точки проводится парабола с вертикальной осью $\varphi_x$. 

интеграл заменяется площадью под параболой

$$
\int_\limits{x_0}^{x_2}\approx\frac h3(y_0+4y_1+y_2)
$$

$$
R = \int ydx - \frac h3(y_0+4y_1+y_2)=-\frac{h^5}{90}\cdot y^{(IV)}(\xi), \quad\xi\in(x_1, x_2)
$$

эта формула является точной для полиномов второй и третьей степени

### Общая формула Симпсона

пусть $n = 2m$ (четное число); $y_i = f(x_i)$ для равноотстоящих точек $a=x_0, x_1, \ldots, x_n = b$ с шагом $h = \frac{b-a}n=\frac{b-a}{2m}$

Применяем формулу Симпсона к каждому удвоенному промежутку: $[x_0, x_2]$, $[x_2, x_4], \ldots, [x_{2m-2}, x_{2m}]$, получаем

$$
\int\limits_a^b ydx = \frac h3 (y_0+4y1+y2)+\frac h3(y_2+4y_3+y+4)+\ldots+\frac h3(y_{2m-2}+4y_{2m-1}+y_{2m})=
$$

$$
= \frac h3\left[y_0+y_{2m}+4(y_1+y_3+\ldots+y_{2m-1})+2(y_2+y_4+\ldots+y_{2m-2})\right]=
$$

$$
= \frac{b-a}{3n}[y_0+4y_1+2y_2+4y_3+2y_4+\ldots+2y_{n-2}+4y_{n-1}+y_n]
$$

В компактной форме эта формула имеет следующий вид

$$
\int\limits_a^bydx\approx \frac h3 \sum_{j=0}^n c_j\cdot y(x_j), \quad c_j = 1,4,2,4,2,\ldots,2,4,1, \quad n=2m\quad h=\frac{b-a}n
$$

Суммируя ошибки по всем двойным интервалам, мы получаем

$$
R = -\frac{h^5}{90}\sum_{k=1}^m y^{IV}(\xi_k) = -\frac{mh^5}{90}\cdot y^{IV}(\xi)=-\frac{(b-a)h^4}{180}\cdot y^{IV}(\xi), \quad \xi\in[a, b]
$$

$$
M_4 = \max|y^{IV}(x)|
$$

$$
(b-a)\cdot\frac{h^4}{180}M_4\leq\Delta
$$

$$
h \leq \sqrt[4]{\frac{180\Delta}{(b-a)M_4}}
$$

Во многих случаях оценка погрешности формулы Симпсона в соответствии с выражением $-(b-a)\cdot\frac {h^4}{180}y^{IV}(\xi)$ затруднительна. Тогда обычно применяют двойной пересчет с шагами $h$ и $2h$ и считают, что совпадающие десятичные знаки принадлежат точному значению интеграла.

---
## Метод трапеции

Вычислили интеграл F(x) на [a. b] с некоторым шагом h и получили значнеие $I_h$. Погрешность при этом равняется $\Delta_h = -\frac{h^2(b-a)F’‘(\xi_1)}{12}$. 

Отсюда точное значение интеграла $S$ равняется приближенному значению плюс погрешности: $S = I_h + \Delta_1$

Пусть мы снова вычислили этот интеграл, но уже с шагом $h_2= h/4$ с другой погрешностью $\Delta_2 = -\frac{h^2(b-a)F’‘(\xi_2)}{12}$. $S = I_{h/4} + \Delta_2$

Теперь разделим $\Delta_1$ на $\Delta2$:

$$
\frac{\Delta_1}{\Delta_2} = 16-\frac{F''(\xi_1)}{F''(\xi_2)}\approx16
$$

Получается первое приближение, $\Delta_1\approx 16\Delta_2$


Дальше приравниваем точные значения $S$:

$$
I_h + \Delta_1 = I_{h/4} + \Delta_2
$$

$$
I_{h/4} - I_h \approx 15\Delta_2
$$

$$
\Delta_2 \approx \frac{I_{h/4} - I_h}{15}
$$

то есть если мы вычислили интеграл с шагом h, а потом вычислили более точно с более мелким шагом, можем оценить, насколько изменилась при этом погрешность

Таким образом, если мы вычисляем по формуле трапеции интеграл $I$

$$
I = \int\limits_a^b f(x)dx
$$

разделив отрезок [a, b] в первый раз на n частей, а второй – на 4n частей, то для второго, более точного результата $I_{4n}$, погрешность приблизительно будет равняться 1/15 разности результатов $I_{4n} - I_n$.

Количество верных цифр в значении $I_{4n}$ на единицу больше количества общих цифр, которые имеют значение $I_{4n}$ и $I_n$.

## Метод Симпсона

Пусть надо посчитать интеграл от F(x) на [a, b]
- вычисляем первый раз в шагом $h_1$ – получаем значение $I_1$, при этом погрешность будет равна $\Delta_1 = -\frac{h^4(b-a)F^{IV}(\xi_1)}{180}$
- точное значение равно $S = I_1+\Delta_1$ (мы найдём точку $\xi_1$, для которой это будет точно)
- вычисляем второй раз с шагом $h_2 = h/2$ и получаем $I_2$ и $\Delta_1 = -\frac{h^4(b-a)F^{IV}(\xi_1)}{16\cdot180}$
- $S  = I_{h/2}+\Delta_2$

выполняем те же действия

$$
\frac{\Delta_1}{\Delta_2}=16-\frac{F^{IV}(\xi_1)}{F^{IV}(\xi_2)}\approx 16\implies \Delta_1\approx 16\Delta_2
$$

приравниваем точные значения

$$
I_h+\Delta_1=I_{h/2}+\Delta_2
$$

$$
I_{h/2} - I_h\approx 15\Delta_2
$$

$$
\Delta_2\approx\frac{I_{h/2}-I_h}{15}
$$

Этой оценкой можно пользоваться при выполнении ДЗ. Но можно сравнивать и с точным значением интеграла.

Таким образом, если мы вычисляем интеграл по формуле Симпсона, разделив отрезок [a, b] первый раз на n частей, а второй – на 2n частей, то для второго результата $I_{2n}$ погрешность приблизительно будет равняться 1/15 от разности результатов $I_{2n}-I_n$

Количество верных цифр в значении $I_{2n}$ на единицу больше количества общих цифр, которые имеют значения $I_{2n}$ и $I_n$.

### ДЗ

Вычислить интеграл от заданной функции $f(x)$ на заданном отрезке [a, b] методом трапеции и методом Симпсона.

**Примечание**. При применении метода трапеций отрезок [a, b] с целью оценки точности разделить на n = 4 и на n = 16 частей. 

При применении метода Симпсона отрезок [a, b] с целью оценки точности разделить на n = 4 и на n = 8 частей. 

Сравнить результаты с точным значением интеграла. Указать верные значащие цифры в результатах. Результаты свести в таблицы следующего вида

# Численные решения ОДУ

Простейшим ОДУ называется уравнение первого порядка. Оно имеет следующий вид

$$
\frac{dy}{dx} = f(x, y)
$$

Правая часть может быть достаточно сложной. Иногда пишут так:

$$
y' = f(x, y)
$$

Здесь x – независимая переменная. y(x) – это функция, которую мы ищем – искомая интегральная кривая.

Решить уравнение - это найти функцию y(x), которая обращает уравнение в тождество. Основной задачей при работе с уравнением является задача Коши.

## Постановка задачи Коши

Найти решение уравнения $y = y(x)$ , которое удовлетворяет начальному условию $y(x_0) = y_0$, то есть интегральная кривая должна пройти через эту точку. В противном случае мы имеем множество решений.

Для дифференциального уравнения n-го порядка

$$
y^{(n)}=f(x, y, y', y'', \ldots, y^(n-1))
$$

задача Коши состоит в нахождении решения $y(x)$, которое удовлетворяет начальным условиям

$$
\begin{cases}
y(x_0) = y_0 \\\
y'(x_0) = y'_0 \\\
\ldots\\\
y^{(n-1)}(x_0) = y_0^{(n-1)}
\end{cases}
$$

Численных решений дифференциальных уравнений несколько. 

Методы работают так: у нас имеется начальная точка $(x_0, y_0)$ (задача Коши), и мы начинаем от неё переходить к точкам $(x_1, y_1)$, $(x_2, y_2)$ и так далее.

## Метод Эйлера и его модификации

### Характеристики

Это наиболее простые и наглядные методы. Исключительно удобны при невысокой точности вычислений. Широко применяются, удобны при использовании в ЭВМ.

---
Пусть дано уравнение $y’ = f(x, y) \quad(1)$ с начальным условием $y(x_0) = y_0$. Нас интересует $y = y(x)$.

1. Выбрав достаточно малый шаг h, мы строим систему равноотстоящих точек $x_i = x_0+ih, i=0, 1, 2, \ldots$.
2. Подставляя $(x_0, y_0)$ в уравнение (1), получаем производную $y’ = f(x_0, y_0)$. Умножаем полученное значение $y’$ на $h$ и получаем $\Delta y_0$. Прибавляя к известному $y_0$ найденное $\Delta y_0$, получаем $y_1$.
	- $\Delta y_0 = y’ \times h$
	- $y_1 = y_0 + \Delta y_0$
3. Аналогично получаем производную $y’ = f(x, y_1)$, получаем $\Delta y_1$ и точку $y_2$


### Математическая запись метода

$$
y_{i+1} = y_i + \Delta y_i, \quad \Delta y_i = h\cdot f(x_i, y_i)
$$

### Недостатки

- низкая точность
- системное накопление ошибок
- при $h\to 0$ последовательность ломаных Эйлера равномерно стремится к искомой интегральной кривой $y = y(x)$

### Модификации метода Эйлера

Их цель – повышение точности.

$$
\begin{cases}
y_{i+1} = y_i+h\cdot f_i \\\
f_i = f(x, y_i)
\end{cases}
$$

#### Усовершенствованный метод Эйлера

$$
\begin{cases}
y_{i+1} = y_i + h\cdot f_{i+\frac12} \\\
f_{i+\frac 12} = f(x_{i+\frac 12}, y_{i+\frac 12})
\end{cases}
$$

То есть мы ищем производную не на концах отрезков (на самих узлах), а в середине между узлами. Почему-то очевидно, что точность будет выше.

Вычисления на каждом шаге:
1. Середина отрезка $x_{i+\frac 12} = x_i+\frac h2$
2. $y_{i+\frac 12} = y_i+\frac h2 \cdot f_i$ (по методу Эйлера)
3. $f_{i+\frac 12} = f(x_{i+\frac 12}, y_{i+\frac 12})$
4. $y_{i+1} = h\cdot f_{i+\frac 12}+y_i$

#### Усовершенствованный метод Эйлера-Коши

$$
\begin{cases}
y_{i+1} = y_i + h\cdot\displaystyle\frac{f_i+\tilde f_{i+1}}{2} \\\
f_i = f(x, y_i) \\\ 
\tilde f_{i+1}\approx f(x_{i+1}, y_{i+1})
\end{cases}
$$

то есть мы прибавляем средние значения производных на отрезка

1. Находится грубое приближение $\tilde y_{i+1} = y_i+h \cdot f_i$ (по методу Эйлера)
2. Находим значение производной $\tilde f_{i+1} = f(x_{i+1}, \tilde y_{i+1})$
3. $y_{i+1} = y_i+h\cdot\displaystyle\frac{f_i+\tilde f_{i+1}}2$

При применении метода Эйлера и его модификаций процесс вычислений сводится к однообразно повторяющимся циклам. Каждый из циклов обеспечивает переход от значения $y(x_i)$ к значению $y(x_{i+1})$, начиная с начального. Поэтому схема вычисления легко программируется и удобна для реализации на ЭВМ.

## Метод Рунге-Кутта

Обладает высокой точностью. Широко применяется, удобен при использовании в ЭВМ.

Пусть дано $y’ = f(x, y)$ с начальными условиями $y(x_0) = y_0$. Нас интересует y(x).

Выберем шаг h и введем обозначение (i = 0, 1,2, …)

$$
x_i = x_0+i\cdot h
$$

$$
y_i = y(x_i)
$$

Рассмотрим числа

$$
\begin{cases}
K_1^{(i)} = h\cdot f(x_i, y_i)\\\
K_2^{(i)} = h\cdot f(x_i+\frac h2, y_i + \frac{K_1^{(i)}}2)\\\
K_3^{(i)} = h\cdot f(x_i+\frac h2, y_i + \frac{K_2^{(i)}}{2})\\\
K_4^{(i)} = h\cdot f(x_i+h, y_i + {K_3^{(i)}})
\end{cases}
$$

Согласно обычному методу Рунге-Кутта последовательные значения вычисляются по формуле

$$
y_{i+1} = y_i+\Delta y_i
$$

$$
\Delta y_i = \frac 16(K_1^{(i)}+2K_2^{(i)}+2K_3^{(i)}+K_4^{(i)})
$$

Погрешность на каждом шаге

$$
\Delta y =\frac 16 (K_1+2K_2+2K_3+K_4)+O(h^5)
$$

Формула имеет 4 порядок точности.

### Определение шага

На каждом этапе, состоящем из двух шагов, применяют двойной пересчет. А именно, исходя из текущего верного значения $y(x_i)$, вычисляют величину $y(x_i+2h)$ двумя способами: один с шагом h, а другой – с более крупным шагом H = 2h. Если расхождения полученных значений не превышают допустимых погрешностей, то шаг h выбран правильно, и полученные с его помощью значения можно принять за очередное верное значение $y(x_i+2h)$. 

В противном случае шаг уменьшают в два раза. Подобные вычислительные схемы легко реализуются на ЭВМ.

### Краткая характеристика

Метод Рунге-Кутта обладает высокой точностью и широко применяется для численного решения дифференциальных уравнений с помощью ЭВМ.

Важным преимуществом этого метода является возможность применения переменного шага.

## Порядок точности решения дифференциального уравнения

Если решение идёт с порядком точности m и шагом h, то на каждом шаге h появляется такая погрешность:

$$
\Delta\sim O(h^{m+1})\approx A\cdot h^{m+1}
$$

Порядок точности m, как правило, известен.

## Принцип Рунге

Он позволяет грубо оценить точность решения дифференциального уравнения

Пусть есть метод решения с порядком точности m. Допустим, сделали 2n шагов. Тогда погрешность будет 

$$
\Delta\approx A\cdot 2nh^{m+1}
$$

или то решение, которое мы получили минус точное решение:

$$
\tilde y_{2n} - y_{2n} = A\cdot 2nh^{m+1}
$$

Теперь мы делаем то же самое, но в n шагов. Получается, шаги в два раза крупнее:

$$
\tilde Y_n - y_{2n} = A\cdot n (2h)^{m+1}
$$

Тогда, приравнивая точные решения, получаем

$$
\tilde y_{2n}-2nAh^{m+1}=\tilde Y-2^{m+1}Anh^{m+1}
$$


$$
A = \frac{\tilde Y - \tilde y_{2n}}{2n(2^m-1)h^{m+1}}
$$

подставляя константу $A$ в исходное уравнение, получаем

$$
y_{2n} = \tilde y_{2n} - \frac{\tilde Y - \tilde y_{2n}}{(2^m-1)}
$$

Для метода Рунге-Кутта m = 4. Для этого метода имеем грубую оценку:

$$
y_{2n} = \tilde y_{2n} - \frac 1{15}(\tilde Y - \tilde y_{2n})
$$

# Приближенные решения алгебраических и трансцендентных уравнений

Если уравнение алгебраическое или трансцендентное является достаточно сложным, то его корни редко удаётся найти точно.

Алгебраическое уравнение – это уравнение вида

$$
a_0x^n+a_1x^{n-1}+a_2x^{n-2}+\ldots+a_n = 0
$$

Здесь $n$ – целое положительное число. Оно называется **степенью уравнения**.

Все остальные уравнения – трансцендентные. Например:

$$
\cos x = x
$$

$$
\log x = x -5
$$

$$
2^x =\lg x + x^5 + 40
$$

---
Пусть исходное уравнение 

$$
\tag{1}f(x) = 0
$$

**Определение**. Всякое значение $\xi$, которое при подстановке в уравнение обращает функцию $f(x)$ в 0 ($f(\xi) = 0$), называется корнем уравнения или нулём функции $f(x)$.

Будем полагать, что уравнение (1) имеет лишь изолированные корни. То есть для каждого корня существует окрестность, не содержащая других корней этого уравнения.

Нахождение корней уравнения (1) складывается из двух этапов:
1. **Отделение корней**. На этом этапе устанавливаются (возможно тесные) промежутки $[\alpha, \beta]$, в которых содержится один и только один корень уравнения 1.
2. **Уточнение величин корней**. На этом этапе выполняется доведение корней до заданной точности. 

## Отделение корней

Для отделения корней полезна следующая теорема матанализа:

### Теорема 1

Если непрерывная функция $f(x)$ принимает значения разных знаков на концах отрезка $[\alpha, \beta]$, то есть $f(\alpha)\times f(\beta) < 0$, то на этом отрезке содержится по крайней мере один корень уравнения $f(x) = 0$.

То есть найдётся хотя бы одно число $\xi\in[\alpha, \beta]: f(\xi) = 0$.


### Теорема 2

Развитие теоремы 1.

Корень внутри интервала $(\alpha, \beta)$ будет единственным, если производная $f’(x)$ существует и сохраняет постоянный знак внутри этого интервала.

То есть $f’(x) > 0 \space(f'(x) < 0), \quad \alpha < x < \beta$

---

Процесс отделения корней начинается с нахождения знаков функции в граничных точках $x = \alpha, x = \beta$ области её (функции) определения. 

Затем определяются знаки функции $f(x)$ в ряде промежуточных точек $x = \alpha_1, x = \alpha_2, \ldots$, выбор которых учитывает особенности функции. Если окажется, что $f(\alpha_k)\cdot f(\alpha_{k+1}) < 0$, то в интервале $(\alpha_k, \alpha_{k+1})$ имеется корень уравнения $f(x) = 0$.

Для отделения корней часто бывает достаточно провести процесс половинного деления, приближенно деля интервал $(\alpha, \beta)$ на 2, 4, 8, … равных частей.

Полезно помнить, что алгебраическое уравнение n-ой степени $a_0x^n+a_1x^{n-1}+a_2x^{n-2}+\ldots+a_n = 0$ имеет не более n действительных корней. Поэтому если для такого уравнения мы получили n перемен знаков, то все корни отделены.

#### Пример

Отделить корни уравнения

$$
f(x) = x^3-6x+2=0
$$

составляем таблицу


| x   | f(x)   | x | f(x) |
| --- | ------ | -------- | --------- |
| $-\infty$   | - |1   | -          |
| -3   | -  | 3  |  +   |
| -1   | +  | $+\infty$  | +   |
| 0   | +  |          |           |

Всего 3 перепада => корни находятся в интервалах
- (-3, -1)
- (0, 1)
- (1, 3)


### Теорема 3

Пусть $\xi$ – точный, а $\tilde x$ – приближенный корни уравнения $f(x) = 0$, и они находятся на одном и том же отрезке $[\alpha, \beta]$. Причем находится такое значение $m: |f'(x)|\geq m > 0$ на этом отрезке.

В таком случае справедлива формула

$$
|\tilde x - \xi|\leq \frac{|f(\tilde x)|}{m}
$$


Доказательство строится так:

по т. Лагранжа для этого отрезка:

$$
f(\tilde x) - f(\xi) = (\tilde x - \xi)\cdot f'(c), \quad \tilde x < c < \xi\implies c\in(\alpha, \beta)
$$

тогда , переписывая это уравнение так

$$
(\tilde x - \xi) = \frac{f(\tilde x) -\overbrace{f(\xi)}^0}{f'(c)}
$$

если подставить сюда m, получим

$$
|\tilde x - \xi|\leq \frac{|f(\tilde x)|}{m}
$$

### Методы нахождения корней

#### 1. Графическое решение уравнений

Уравнение $f(x) = 0$ 

1. Действительные корни мы можем определить как абсциссы точек пересечения графика функции $y = f(x)$ с осью X. Этим способом корни легко отделяются (можно так делать в БДЗ, и сразу станет понятно, какие интервалы брать)
2. На практике часто бывает удобно уравнение $f(x)$ заменить на равносильное уравнение $\varphi(x) = \psi(x)$. Примеры:
	- $x\lg x = 1\implies \lg x = \frac 1x$
		- точка пересечения графиков $\lg x$ и $\frac 1x$ – искомый корень
	- если надо решить два уравнения:
		- $x^3 - 1.75x +0.75 = 0$
		- $x^3+2x+7.8=0$
			- переходим к равносильным уравнениям
			- $y = x^3$
			- $y  =1.75x -0.75$
			- $y = -2x-7.8$
			- рисуем три функции и ищем точки пересечения – это будут корни

#### 2. Метод половинного деления

дано уравнение $f(x) = 0$. при этом $f(x)$ непрерывна на отрезке [a, b], $f(a)\cdot f(b)<0$.

корень уже отделён и находится на этом отрезке.

Отрезок [a, b] делится пополам. Получаем два отрезка $[a, \frac{a+b}2]$ и $[\frac{a+b}2, b]$. Из этих двух отрезков выбираем тот, где знаки функции на концах разные. Это будет отрезок $[a_1, b_1]$. Его мы тоже делим пополам и выбираем нужную половину: и так далее.

$$
\begin{cases}
[a_1, b_1], \ldots[a_n, b_n] \\\
f(a_n)\cdot f(b_n) < 0
\end{cases}
$$

При этом мы выбирали таким образом, чтобы $f(a_n)\cdot f(b_n) < 0$.

Длина n-го отрезка будет

$$
b_n - a_n = \frac 1{2^n}(b-a)
$$

Отсюда следует, что

$$
\lim_{n\to\infty}(b_n-a_n) = 0
$$

$$
\lim a_n = \lim b_n = \xi
$$

$$
\lim f(a_n)\cdot \lim f(b_n)=[f(\xi)]^2\leq 0\implies f(\xi) = 0
$$

значит $\xi$ – корень уравнения и $a_n\leq\xi\leq b_n$.

$$
\xi - a_n\leq \frac 1{2^n}(b-a)
$$

$$
b_n-\xi\leq \frac 1{2^n}(b-a)
$$

если задана $\Delta$ – погрешность, то находя из этого соотношения $n$, мы получаем $\xi-a_n < \Delta$ (или можно работать по правому краю и смотреть $b_n-\xi<\Delta$) – то есть $a_n$ и $b_n$ – оба приближения корня

#### 3. Метод итераций

$f(x)$ – непрерывная функция, нас интересует $\tilde x$ – решение уравнения.

Исходное уравнение заменяем равносильным $x =\varphi(x)\quad(2)$. Для этого можно к левой и правой частям исходного уравнения прибавить $x$.

Выбирается приближенное значение корня $x_0$. Подставляем в правую часть:

$$
x_1 = \varphi(x_0)
$$

и получаем очередное значение приближения $x_1$. 

$$
x_2 = \varphi(x_1)\\\
\ldots \\\
x_n = \varphi(x_{n-1})
$$

Если эта последовательность сходится (то есть существует предел $\xi=\displaystyle\lim_{n\to\infty}x_n\quad (3)$), то, переходя к пределу (3), найдём

$$
\lim_{n\to\infty}x_n= \varphi(\lim_{n\to\infty}x_{n-1})
$$

$$
\xi = \varphi(\xi)
$$

таким образом, получили исходное уравнение => $\xi$ – корень.


##### Графическая иллюстрация метода

==тут должна быть картинка с доски==


#### 4. Метод Ньютона (метод касательных)

Пусть уравнение $f(x) = 0\quad(1)$ и $\xi$ – корень уравнения, отделенный на отрезке [a, b]. При этом будем считать, что $f’(x)$ и $f’'(x)$ непрерывны и сохраняют знаки на этом отрезке.

Пусть $x_n$ – приближение $\xi$. $a\leq x_n\leq b$. По методу Ньютона $x_n$ уточняется следующим образом:

$$
\tag 2\xi = x_n+h_n
$$

Отсюда по формуле Тейлора получаем

$$
f(\xi)=0=f(x_n+h_n)\approx f(x_n)+h_n\cdot f'(x_n)
$$

$$
h_n = -\frac{f(x_n)}{f'(x_n)}
$$

вносим эту поправку $h_n$ в (2):

$$
\tag 3 x_{n+1} = x_n-\frac{f(x_n)}{f'(x_n)}\quad (n = 0, 1, 2, \ldots)
$$

##### Графическая иллюстрация

==другая картинка с доски==

уравнение касательной в точке 

$$
B_n[x_n, f(x_n)]: y=f(x_n)+f'(x_n)(x-x_n)
$$

когда мы получаем y = 0 (точка пересечения с осью Х) в точке $x = x_{n+1}$ – очередном приближении к $\xi$

$$
x_{n+1} = x_n - \tilde{f(x_n)}{f'(x_n)}
$$

получается мы идём к $\xi$ касательными

---

В качестве исходной точки $x_0$ выбирается тот конец интервала (a, b), которому отвечает ордината того же знака (y), что и знак второй производной.

Для оценки погрешности n-го приближения можно воспользоваться общей формулой

$$
|\xi - x_n|\leq \frac{f(x_n)}{m},
$$

где m – наименьшее значение производной $f’(x)\geq m > 0$. (можно брать наименьшее из значений производной)


## Задание на БДЗ

1. Отделить корни уравнения
2. Величину одного из корней уточнить до 3 верных значащих цифр любым методом.

# Линейное программирование

Литература, которая может быть для нас интересна:
1. Аксенюшкина Е.В. Математика:2: нелинейное и линейное программирование. Иркутск (2009)
2. Летова Т.А., Пантелеев А.В. Экстремум функций в примерах и задачах. Учебное пособие. МАИ (1998)

**Линейное программирование** – это раздел математики, изучающий задачи, взаимосвязанные с нахождением максимума или минимума линейной функции многих переменных при ограничениях на величины переменных в форме линейных равенств или неравенств.

Термин “программирование” – перевод от programming (более точный перевод – планирование).

## Математическая постановка общей задачи линейного программирования

Найти максимум или минимум линейной функции 

$$
f(x) = f(x_1, x_2, \ldots, x_n) = c_1x_1+c_2x_2+\ldots+c_nx_n\to\max(\min)
$$

от n переменных $x_1\ldots x_n$, удовлетворяющих $m$ линейным ограничениям в форме равенств или неравенств. Эти ограничения имеют следующий вид.

$$
\begin{cases}
a_{11}x_1+a_{12}x_2+\ldots+a_{1n}x_n\leq(=, \geq) b_1
\\\ \ldots
\\\ a_{m1}x_1+a_{m2}x_2+\ldots+a_{mn}x_n\leq(=, \geq)b_m
\end{cases}
$$

Часто в задачах отдельно записываются условия неотрицательности переменных.

$$
x_i\geq 0 \quad(i=1, 2, \ldots, n)
$$

То есть работаем в первом квадранте, где все величины положительны.

Эти условия определяют выпуклый многогранник G в n-мерном пространстве, который является областью определения исходной функции $f(\vec x)$. $(\vec x = (x_1, \ldots, x_n)$)

Функция $f(x)$ называется **целевой** функцией.

Коэффициенты $c_i$ образуют вектор $\vec c = (c_1, \ldots, c_n)$ – **целевой** вектор.

Любой вектор $\vec x = (x_1, \ldots, x_n)$, координаты которого удовлетворяют ограничениям, называется **допустимым вектором** (решением, планом, допустимой точкой) задачи линейного программирования. Все эти вектора образуют множество $X$ допустимых решений задачи.

Решение $X^*=(x_1^*, x_2^*, \ldots, x_n^*)\in X$, при котором $f(x)$ принимает наибольшие или наименьшие значения, называется **оптимальным решением задачи линейного программирования**.

ЛП часто используется в экономике, где в основном встречается двумерный случай.

## Линейное программирование. Двумерный случай

### Постановка задачи

1. На плоскости имеется некоторый выпуклый многоугольник, имеющий в общем случае n вершин. Этот многоугольник задаётся системой из n нестрогих линейных неравенств
2. На многоугольнике задана функция 

$$
F(x) = ax+by+c
$$
 
 Требуется найти экстремум этой функции.

Сами линейные неравенства имеют следующий вид:

$$
\begin{cases}
1 a_1x+b_1y\leq c_1\quad (1)
\\\
 2 a_2x+ b_2y\leq c_2\quad (2)
\\\
a_6x+b_6y\leq c_6\quad(6)
\end{cases}
$$

$$
x\geq 0, y\geq 0
$$

Ищем максимум функции F(x)

Получается шестиугольник на плоскости, который задаётся шестью линиями $M_i$.

Этот экстремум находится в одной из вершин многоугольника.

### Теорема

Пусть имеется некоторый выпуклый многоугольник на плоскости, который определен системой из n нестрогих линейных неравенств.

Пусть на многоугольнике задана функция $F(x, y) = ax+by+c$. Тогда $\min$ и $\max$ функции $F(x, y)$ находятся в одной из вершин многоугольника.

Доказательство в два этапа:
1. Доказывается, что минимум и максимум значений функции на любом отрезке прямой, соединяющем две стороны многоугольника, находятся на концах этого отрезка. То есть экстремум функции, которая определена на всём многоугольнике, находится где-то на границе многоугольника. `*картинка многоугольника с доски*`

На этом отрезке:
- $y = \lambda x +\xi$
- $F = ax+b\lambda x +b\xi + c$

Берём производную

$$
\frac{\partial F}{\partial x} = a+b\lambda=const\neq 0
$$

Если на отрезке производная функции константа, это значит, что функция имеет минимальное и максимальное значение на концах этого отрезка.

2. Так как границы многоугольника являются отрезками прямых, то максимум (минимум) значений функции также располагаются на концах отрезков, то есть располагаются в вершинах.

### Обобщение двумерного случая

При решении задач линейного программирования в двумерном случае:
1. На плоскости имеется некоторый выпуклый многоугольник, содержащий в общем случае n вершин.
2. Этот многоугольник задаётся системой из n нестрогих линейных неравенств.
3. На многоугольнике задана целевая функция f = ax + by + c. Требуется найти экстремум этой функции. Этот экстремум находится в одной из вершин многоугольника.

Для решения задачи:
1. Вычисляются координаты вершин
2. Вычисляются значения целевой функции в вершинах
3. Среди вычисленных значений $F(x_1, y_1), \ldots, F(x_n, y_n)$ находятся и минимум, и максимум значений целевой функции.

Координаты вершин находятся так: записываются уравнения, ограничивающие две прямые, на пересечении которых находится вершина

$$
\begin{cases}
a_1x+b_1y= c_1\quad (1)
\\\
a_2x+ b_2y= c_2\quad (2)
\end{cases}
$$

Отсюда находим точку с координатами $M_1(x_1, y_1)$, и так по всем вершинам.

Среди найденных значений в этих точках $F(x_1, y_1), \ldots, F(x_6, y_6)$ находятся экстремумы. Это непосредственное решение задачи линейного программирования, но не является оптимальным.

### Графоаналитический метод решения задачи линейного программирования

Этим методом решать задачу в БДЗ

Пусть имеется линейная функция $f(x) = c_1x_1+c_2x_2 = 3x_1+2x_2$. Надо найти максимум этой целевой функции на выпуклом многоугольнике

$$
\begin{cases}
1\cdot x_1+2x_1\leq 6
\\\
2x_1+1\cdot x_2\leq 8
\\\
-x_2+x_2\leq 1
\\\
x_1\geq0, x_2\geq 0
\end{cases}
$$

Каждое нестрогое линейное неравенство определяет полуплоскость. Пересечения полуплоскостей дают выпуклый многоугольник.

При этом для полуплоскости ограничивающая прямая $P_1:1x_1+2x_2=6$ , для $P_2$ и $P_3$ аналогично.

Строится выпуклый многоугольник `*картинка с доски*`

Градиент функции

$$
\operatorname{grad} f = \left\lbrace\frac{\partial f}{\partial x_1}, \frac{\partial f}{\partial x_2}\right\rbrace = \lbrace{3, 2}\rbrace = \lbrace{c_1, c_2}\rbrace
$$

Градиент функции показывает координаты целевого вектора.

Строятся такие изолинии:

$$
f(x) = 3x_1+2x_2 = h
$$

Это прямые, на которых функция принимает постоянное значение. По изолинии функция не растёт, она перпендикулярна градиенту. Перемещаем в пространстве изолинию, меняя h, до тех пор, пока изолиния не коснётся крайней точки многоугольника.

Когда мы графически нашли эту точку (в ней находится экстремальное значение) приближённо, решаем точно:

$$
\begin{cases}
P_1: x_1+2x_2 = 6
\\\
P_2: 2x_1+x_2=8
\end{cases}
$$

Это мы записали уравнения ограничивающих прямых до крайней точки. Решая уравнения, получаем $x_1 = 3\frac 13, x_2 = 1\frac 13$. Подставляя эту точку в функцию, получаем максимальное значение.

## Графоаналитический метод решения стандартных задач линейного программирования с двумя переменными (двумерный случай)

1. Для каждого ограничения – неравенства записывается уравнение граничной прямой посредством замены знака неравенства на знак равенства.
2. На координатной плоскости строятся все граничные прямые
3. Для каждого ограничения определяется его полуплоскость
4. Находится область пересечения всех полуплоскостей (многоугольник допустимых решений).
5. Изображается целевой вектор $\nabla f = {c_1, c_2}$ или $\vec c = \{c_1, c_2\}$. 
6. Через допустимые множества решений проводится перпендикуляр к целевому  вектору. Это линия уровня целевой функции
7. Посредством перемещения линии уровня параллельно самой себе в направлении целевого вектора находится граничная точка множества решений. Эта точка определяется визуально. Она является точкой максимума (так как двигались в направлении градиента)
8. Вычисляются координаты точки максимума (посредством решения соответствующей системы уравнений) и максимум целевой функции.

### Замечание

Для определения точки минимума следует перемещать изолинию против направления целевого вектора.

## Стандартная задача линейного программирования

Найти максимум линейной функции $f(x) = c_1x_1+\ldots + c_nx_n \to\max$ от n переменных, удовлетворяющий m линейным ограничениям в форме нестрогих неравенств вида

$$
\begin{cases}
a_{11}x_1+a_{12}x_2+\ldots+a_{1n}x_n\leq b_1
\\\ \ldots
\\\ a_{m1}x_1+a_{m2}x_2+\ldots+a_{mn}x_n\leq b_m
\end{cases}
$$

при условии неотрицательности:

$$
x_i\geq 0;\quad i=1, 2, \ldots, n
$$

Соотношение между n и m в стандартной задаче ЛП может быть произвольным. 

К этой форме приводятся, например, задачи, решаемые графоаналитическими методами.

## Каноническая задача линейного программирования

Найти максимум линейной функции $f(x) = c_1x_1+\ldots + c_nx_n \to\max$ от n переменных $x_1, \ldots, x_n$, удовлетворяющей m линейным ограничениям в форме **равенств** вида


$$
\begin{cases}
a_{11}x_1+a_{12}x_2+\ldots+a_{1n}x_n= b_1
\\\ \ldots
\\\ a_{m1}x_1+a_{m2}x_2+\ldots+a_{mn}x_n= b_m
\end{cases}
$$

при условии неотрицательности:

$$
x_i\geq 0;\quad i=1, 2, \ldots, n
$$

К этой форме приводится, например, задачи, решаемые симплекс-методом. 

В канонической задаче количество линейных независимых уравнений m должно быть меньше количества переменных n. В этом случае система ограничений имеет множество допустимых решений $X = X(x_1, \ldots, x_n)$. Из этих допустимых решений необходимо выбрать то решение $X^* = (x_1^*, \ldots, x_n^*)$, при котором целевая функция $f(x_1, \ldots, x_n)$ принимает максимальное значение.

## Эквивалентные преобразования задач линейного программирования

Конкретная задача ЛП в зависимости от содержания может иметь ограничения как типа равенств, так и неравенств, а целевая функция может подлежать максимизации или минимизации. Тем не менее, любую задачу ЛП можно привести как к канонической, так и к стандартной форме с помощью эквивалентных преобразований.

В БДЗ будет подобрана задача, заведомо не имеющая стандартной формы. Её надо будет привести к стандартной, а потом к канонической.

1. $F = F(x_1, \ldots, x_n) = c_1x_1+\ldots+c_nx_n\to\min$. Чтобы задача подходила к стандартной форме, берём $-F = -c_1x_1-\ldots-c_nx_n\to\max$.
2. Есть ограничение $a_{k1}x_1+\ldots+a_{kn}x_n\geq b_k$. Чтобы привести ограничение к стандартной форме, надо развернуть знак неравенства: левую и правую части умножить на -1. Получаем $-a_{k1}x_1-\ldots-a_{kn}x_n\leq -b_k$
3. Стандартное ограничение $a_{k1}x_1+\ldots+a_{kn}x_n\leq b_k$ нужно привести к канонической форме, то есть в виде равенства. Из правой части вычитаем левую часть и вводим новые обозначения переменной:
	- $b_k - (a_{k1}x_1+\ldots+a_{kn}x_n) = x_{n+1}\geq 0$
	- получаем такое условие: $a_{k1}x_1+\ldots+a_{kn}x_n+x_{n+1}=b_k$
4.  $a_{k1}x_1+\ldots+a_{kn}x_n\geq b_k$ нужно привести к равенству. Приём такой же
	- $(a_{k1}x_1+\ldots+a_{kn}x_n) - b_k = x_{n+1}\geq 0$
	- получаем $a_{k1}x_1+\ldots+a_{kn}x_n-x_{n+1}=b_k$
5. Ограничение в форме равенства $a_{k1}x_1+\ldots+a_{kn}x_n= b_k$ надо привести к стандартному ограничению $\geq$.
	- вводим два неравенства 
		- $a_{k1}x_1+\ldots+a_{kn}x_n\leq b_k$
		- $a_{k1}x_1+\ldots+a_{kn}x_n\geq b_k$


### Пример

Привести к стандартной и канонической форме следующую задачу ЛП
- $f(x) = 4x_1-6x_2-2x_3+3x_4+5x_5\to\min$
- ограничения
	- $x_1+2x_2-3x_3+x_4-3x_5\geq-5$
	- $2x_1+3x_2+x_3+x_4+2x_5\geq1$
	- $-2x_1-x_2-x_4-x_5\leq3$
	- $x_i\geq0, \quad i=1\ldots5$


- умножаем на -1, чтобы привести не к минимуму, а к максимуму
	- $-f(x)=-4x_1+6x_2+2x_3-3x_4-5x_5\to \max$
	- аналогично с ограничениями
		- $x_1-2x_2+3x_3-x_4+3x_5\leq 5$
		- $-2x_1-3x_2-x_3-x_4-2x_5\leq -1$
		- третье ограничение и так было в стандартном виде, просто переписываем
		-  $-2x_1-x_2-x_4-x_5\leq3$
		- $x_i\geq0, \quad i=1\ldots5$

теперь полученную задачу надо привести к каноническому виду

- умножаем целевую функцию на -1
	- $-f(x)=-4x_1+6x_2+2x_3-3x_4-5x_5\to \max$
- вводим дополнительные положительные переменные
	- $x_1+2x_2-3x_3+x_4-3x_5-\tilde x_6 = -5$
		- $\tilde x_6$ – это вводимая положительная переменная
	- $2x_1+3x_2+x_3+x_4+2x_5-\tilde x_7=1$
	- $-2x_1-x_2-x_4-x_5+\tilde x_8=3$
	- $x_i\geq0, \quad i=1\ldots8$

Первую систему мы бы решали графоаналитикой, вторую – симплекс методом.

## Симплекс-метод решения задач линейного программирования

Симплекс-метод – метод последовательного перехода от одного базисного решения (вершины многогранника решений) к другому базисному решению до тех пор, пока целевая функция не примет оптимального значения (максимум или минимум).

### Характеристика метода

Это универсальный метод. Им можно решить любую задачу линейного программирования.

Он предложен американским математиком Р. Данцигом в 1947 году. Этим методом решаются задачи с несколькими тысячами переменных и ограничений. 

### Алгоритм симплекс-метода

1. Привести задачу ЛП к канонической форме. На этом этапе для $m$ ограничений вводятся $m$ дополнительных переменных. 
2. Вновь введённые $m$ переменных принимаются за основные (базисные) и выражаются через неосновные переменные, соответствующим базисным решениям.
3. Целевая функция выражается через неосновные переменные. Если в ней нет неосновных переменных с отрицательными коэффициентами, то полученное базисное решение является оптимальным. Если же в ней присутствуют неосновные переменные с отрицательными коэффициентами, то необходимо перейти к новому базисному решению.
4. Из неосновных переменных выбирают ту, которой соответствует наибольший по модулю коэффициент, и далее её переводят в основные переменные.
	- **Примечание**. Если в оптимальной линейной форме отсутствует хотя бы одна неосновная переменная, то полученное оптимальное решение не является единственным.

### Пример

Найти максимум функции (целевой функции) $F = x_1+2x_2$  с ограничениями
- $-x_1+2x_2\geq 2$
- $x_1+x_2\geq 4$
- $x_1-x_2\leq 2$
- $x_2\leq 6$
- $x_1 \geq0, x_2\geq 0$

1. Вводим добавочные неотрицательные переменные. 4 ограничения => 4 переменных. Записываем систему ограничений в канонической форме

- $-x_1+2x_2-x_3= 2$


$$
\begin{cases}
-x_1&+2x_2&-x_3&&&&=2\\\
x_1&+x_2&&-x_4&&&=4\\\
x_1&-x_2&&&+x_5&&=2\\\
\quad &x_2&&&&+x_6&=6
\end{cases}
$$

x1, x2 - основные переменные. Выразим базисные переменные через основные переменные и свободные члены

- $x_3 = -2 - (x_1-2x_2)$
- $x_4=-4-(-x_1-x_2)$
- $x_5=2-(x_1-x_2)$
- $x_6=6-(x_2)$

целевую функцию также выразим через неосновные переменные и свободные члены:

- $F = 0 - (-x_1-2x_2)$

составляем первую симплекс таблицу (таблица 1)

| Основные переменные (базисные) | Свободные члены | Неосновные переменные |       | Вспомогательные коэффициенты |
| ------------------------------ | --------------- | --------------------- | ----- | ---------------------------- |
|                                |                 |                       |       |                              |
|                                |                | $x_1$                 | $x_2$ |                              |
|                                |                 |                       |       |                              |
| $x_3$                          | -2              | 1                     | -2    |                              |
| $x_4$                          | -4              | -1                    | 1     |                              |
| $x_5$                          | 2               | 1                     | -1    |                              |
| $x_6$                          | 6               | 0                     | 1     |                              |
| $F$                            | 0               | -1                    | -2      |                              |

У нас есть неосновные переменные с отрицательными коэффициентами. Поэтому надо переходить к следующей симплекс-таблице (таблица 2). Этот переход стандартный.

Последняя строка, в которой записаны коэффициенты $F$, называется индексной строкой. Коэффициенты целевой функции отрицательные, поэтому решение неоптимальное. Нужно построить новую таблицу, опираясь на предыдущую.

Вначале находится ведущий элемент в таблице: находим ведущий столбец – столбец, в котором максимум модулей коэффициентов целевой функции $\max\{|-1|, |-2|\} = 2$. Ведущий столбец – с $x_2$.

Далее находим ведущую строку. Делим свободные члены на элементы ведущего столбца, и минимальный элемент укажет на ведущую строку.
- (свободные члены) : ($x_2$) = (1, 4, $\infty$ (так как 2:(-1) – отрицательная величина), 6)
- $\min\{1, 4, \infty, 6\} = 1$
- ведущая строка $x_3$

Ведущий элемент – -2 (на пересечении столбца $x_2$ и строки $x_3$).

$x_2$ и $x_3$ меняются местами: $x_2$ переходит в основные переменные, а $x_2$ – в неосновные. Все строки, кроме $x_2$, сохраняются. Строка $x_2$ заполняется так: где пересечение координат $(x_2, x_3)$ – величина, обратная ведущему элементу. Остальные числа делятся на ведущий элемент.

Далее заполняется столбец вспомогательными коэффициентами. Туда переносится старый столбец $x_2$ со знаком минус.

Строка $x_4$ заполняется так: берутся элементы строки $x_2$ и домножаются на вспомогательный коэффициент у строки $x_4$. Далее к полученным элементам прибавляются старые значения из этой строки
- $x_4 = (1, -\frac 12, -\frac 12)\times 1 + (x_{4_{пред}})$

Эта операция проводится для всех остальных строк.

| Основные переменные (базисные) | Свободные члены | Неосновные переменные |       | Вспомогательные коэффициенты |
| ------------------------------ | --------------- | --------------------- | ----- | ---------------------------- |
|                                |                 |                       |       |                              |
|                                |               | $x_1$                 | $x_3$ |                              |
|                                |                 |                       |       |                              |
| $x_2$                          | 1              | $-\frac 12$                     | $-\frac 12$   |                              |
| $x_4$                          | -3              | $-\frac 32$                    | -1/2     |      1                        |
| $x_5$                          | 3               | 1/2                     | -1/2    |       1                       |
| $x_6$                          | 5               | 1/2                    | 1/2     |        -1                      |
| $F$                            | 2               | -2                    | -1      |      2                        |

- {$x_4$}: 1x1-4=-3; (-1/2)x1-4=-3/2; (-1/2)x1+0=-1/2
- {$x_5$}: 1x1+2=3; (-1/2)x1+1=1/2; (-1/2)x1+0=-1/2
- {$x_6$}: 1x(-1)+6-5; (-1/2)x(-1)+0=1/2; (-1/2)x(-1)+0=1/2
- {F}: 1x2+0=2; (-1/2)x2+(-1)=-2; (-1/2)x2+0=-1

Полученное решение опять неоптимальное, так как в индексной строке при неосновных переменных коэффициент отрицательный. Переходим к таблице 3.

Так же ищем ведущий столбец и ведущую строку в таблице 2. 
- ведущий элемент – $(x_4, x_1)$
	- ведущий столбец – -2 у F
	- делим свободные члены на ведущий столбец, получаем $(\infty, 2, 6, 10)$, минимум 2 – у строки $x_4$

| Основные переменные (базисные) | Свободные члены | Неосновные переменные |       | Вспомогательные коэффициенты |
| ------------------------------ | --------------- | --------------------- | ----- | ---------------------------- |
|                                |                 |                       |       |                              |
|                                |                 | $x_4$                 | $x_3$ |                              |
|                                |                 |                       |       |                              |
| $x_1$                          | 2               | $-\frac 23$           | 1/3   |                              |
| $x_2$                          | 2               | -1/3                  | -1/3  | 1/2                          |
| $x_5$                          | 2               | 1/3                   | -2/3  | -1/2                         |
| $x_6$                          | 4               | 1/3                   | 1/3   | -1/2                         |
| $F$                            | 6               | -4/3                  | -1/3    | 2                            |

Это очередное решение опять не оптимальное :c

Переходим к таблице 4 … 

В таблице 3 ведущий элемент – $(x_4, x_5)$


| Основные переменные (базисные) | Свободные члены | Неосновные переменные |       | Вспомогательные коэффициенты |
| ------------------------------ | --------------- | --------------------- | ----- | ---------------------------- |
|                                |                 |                       |       |                              |
|                                |                 | $x_5$                 | $x_3$ |                              |
|                                |                 |                       |       |                              |
| $x_4$                          | 6               | **3**                     | -2    |                              |
| $x_1$                          | 6               | 2                     | -1    | 2/3                          |
| $x_2$                          | 4               | 1                     | -1    | 1/3                          |
| $x_6$                          | 2               | -1                    | 1     | -1/3                         |
| $F$                            | 14              | 4                     | -3  | 4/3                          |

решение опять неоптимальное (АААААААААААААААААААААААААААААА)

строим таблицу 5

у нас базисный элемент $(x_4, x_5)$. **Но такой базисный элемент уже был**, поэтому, чтобы не войти в цикл, мы вместо $x_5$ берём столбец $x_3$. Оттуда получаем 

| Основные переменные (базисные) | Свободные члены | Неосновные переменные |       | Вспомогательные коэффициенты |
| ------------------------------ | --------------- | --------------------- | ----- | ---------------------------- |
|                                |                 |                       |       |                              |
|                                |                 | $x_5$                 | $x_6$ |                              |
|                                |                 |                       |       |                              |
| $x_3$                          | 2               | -1                    | 1     |                              |
| $x_1$                          | 10              | 1                     | 2     | 2                            |
| $x_2$                          | 8               | 1                     | 1     | 1                            |
| $x_6$                          | 6               | 0                     | 1     | 1                            |
| $F$                            | 20              | 1                     | 3    | 3                            |

ураааааа, мы получили оптимальное решение

$F = 20 - (x_5 + 3x_6)$

максимальное значение F = 20, оно достигается при 
- $x_5 = 2 - (x_1-x_2) = 0$
- $x_6 = 6 - (x_2) = 0$
- отсюда
	- $x_1 = 8$
	- $x_2 = 6$

### Задание


По заданным величинам определить общий вид функции и одним из известных методов (выбранных точек, средних или методом наименьших квадратов) (любым) определить параметры найденной функции.

### Задание к интерполяции

Применяя формулу Ньютона для интерполяции вперед и назад, вычислить значения функции в двух заданных точках. Можно использовать произвольную формулу (либо в разделенных, либо конечных разностях – отличаются шагом (равномерный или переменный))

### Задание по линейному программированию

1. Привести задачу к стандартному виду и решить её графоаналитическим методом
2. Привести задачу к каноническому виду и решить её симплекс-методом.





