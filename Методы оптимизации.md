**Опр.** Оптимизация -- достижение наилучшего качества при ограничении на ресурсы.

Качество задаётся в виде формулы $f = f(x_1, \ldots, x_n)$ и зависит от $x_1\ldots x_n$.

Рассмотрим достижение максимума/минимума функции $f$ в случаях:
- $-\infty < x_i < \infty$ (ресурсы не ограничены). Используются экстремумы функций многих переменных
- $\leq x_1\ldots x_n\leq$ (ограничения и критерий задаются нелинейными функциями) -- метод нелинейного программирования. (про это есть учебник Химмельблау)
- $\leq x_1\ldots x_n\leq$ (ограничения и критерий задаются линейными функциями) -- $n$-мерный многогранник, высекаемый $n$-мерными плоскостями. Используется метод линейного программирования

ограничения:
- данные даются с какой-то точностью -- потеря точности при округлении
- потеря точности в ЭВМ
- потеря точности в методе

Число -- безразмерная величина. Понятия числа и величины есть синонимы. Одно и то же число в разных СС выглядит по-разному

СС -- система (математический приём) изображения чисел с помощью ограниченного количества символов

Мы работаем с позиционными СС. Это СС, в которой вклад цифр в величину числа зависит от положения цифры в числе относительно запятой

**Опр**. Пусть $A$ - точное значение числа, $a$ - то приближение, с которым мы будем работать. Тогда величина $\Delta = |A-a| = |a-A|$ называется **абсолютной погрешностью $a$**

**Опр**. $\delta = \frac{\Delta}{|A|}$ называется **относительной погрешностью приближенного числа $a$

Абсолютные и относительные погрешности работают в паре. **Они округляются только в большую сторону**. 

Например, $\Delta = 0.099 = 0.1$ 

Возможны два случая для расчета погрешностей:
- $A$ и $a$ известны (редкий случай). Тогда ранее приведенные формулы для погрешностей являются рабочими. Отсюда находим $\delta$
- $A$ неизвестно (наиболее часто). $a$ известно. Одним из известных способов находят $\Delta$ или $\delta$ и далее полагают, что $$\delta\simeq\frac\Delta a,$$потому что $A\simeq a$. Работая по этой формуле получаем, что $$a-\Delta\leq A\leq a+\Delta$$

Основные источники погрешностей:
- погрешность исходных данных. При обработке они переходят в результат.
- методическая погрешность. Например, значения интегралов можно считать по формулам прямоугольников, трапеций и каких-то умных челов.


## Десятичная запись приближенного числа. Значащие цифры и верные значащие цифры.

Всякое число $A$ может быть представлено в виде бесконечной дроби (**развернутая запись числа)**$$a=\alpha_1\cdot 10^{m-1} +\alpha_2\cdot 10^{m-2}+\ldots +\alpha_{m-1}10^1+\alpha_m10^0+\ldots+\alpha_n 10^{m-n}$$
В этой записи
- $\alpha_i$ -- десятичные цифры числа, $\alpha_i=\overline{0, 9}$
- $n$ -- разрядность числа 
- $m$ -- количество цифр в целой части числа

Например,
$$3141.59=3\cdot10^3+1\cdot10^2_4\cdot10^1+1\cdot10^0+5\cdot10^{-1}+9\cdot10^{-9}$$
Если ввести ограничение на то, что старший разряд не равен нулю:

$$b = \beta_1\cdot 10^{m-1}+\beta_2\cdot10^{m-2}+\ldots+ \beta_n\cdot 10^{m-n}\quad (\beta_1\neq 0)$$

**Опр**. Все сохраняемые десятичные цифры $\beta_i$ ($i = \overline{1, n}$) называются **значащими цифрами**. В числе 0.007010 цифры 7010 -- значащие.

**Опр**. Значащей цифрой приближённого числа называется всякая цифра в его записи, отличная от нуля; ноль, если он содержится между значащими цифрами или представляет сохраняемый десятичный разряд.

Примеры
- 10.89 - 4 зн цифры
- 0.007010 - 4 зн цифры
- 0.00701 - 3

Специальная математическая запись, показывающая количество значащих цифр:

$$689000 = 6.89 \cdot 10^5$$
- $6.89\cdot 10^5$ - 3 зн цифры
- $6.89000\cdot 10^5$ - 6 зн цифр
- $7\cdot 10^5$ - 1 зн цифра

0.000 000 120 
- с тремя зн цифрами $1.20 \cdot 10^{-7}$
- $1.2\cdot 10^{-7}$ с 2 зн цифрами


**Опр.** Говорят, что $n$ первых значащих цифр приближенного числа $a$ являются **верными**, если абсолютная погрешность этого числа не превышает половины единицы младшего $n$-го разряда.

Т. о. если для приближенного числа $a$ с $n$ разрядами, которое заменяет точное число $A$, известно, что 
$$\Delta=|A-a|\leq\frac12\cdot 10^{m-n},$$
то первые $n$ цифр этого числа $\alpha_1,\ldots,\alpha_n$ являются верными.

Например, если для 42.253 $\Delta = 0.004$
- берем младший разряд. проверяем 3 $\frac {10^{-3}}2=0.0005 < \Delta$ => не является верной зн цифрой
- дальше 5 $\frac{10^{-2}}2=0.005>\Delta$ => верно
подчеркнуть цифры и написать: подчеркнутые цифры являются верными

## Округление чисел

Рассмотрим некоторое число $a_{10}$ в десятичной СС. Иногда требуется записать его с меньшим количеством цифр $a\to a_1$ и выбрать $a_1$ так, чтобы погрешность перехода была наименьшей 

$$| a-a_1 | \to\min$$

это достигается соответствующими правилами округления:
- при округлении до $n$ значащих цифр отбрасываются все цифры, стоящие справа от $n$-ой значащей цифры, и если нужно сохранение разрядностей, заменяют их нулями. Два случая
	- если первая из отбрасываемых цифр меньше 5, то оставшиеся десятичные знаки остаются без изменения
	- если она $\geq 5$, то к последней оставляемой цифре добавляют единицу
- погрешность округления при этом не превышает 1/2 единицы последнего оставляемого десятичного разряда

пример
$\pi = 3.1415926535$
если округлить до 3.1416, то $\Delta\leq\frac12 \cdot 10^4$
- 3.142 $\Delta\leq\frac12 \cdot 10^-3$
- 3.14 $\Delta\leq\frac12 \cdot 10^{-2}$

точность приближенного числа зависит не от количества значащих цифр, а от количества **верных** значащих цифр.

## Практическое правило округления при вычислениях

в промежуточных результатах количество значащих цифр должно превосходить количество верных на одну-две цифры. Окончательный результат может содержать  не более, чем одну излишнюю значащую цифру. Это правило позволяет без ущерба для точности избегать написания лишних цифр.

## Общая формула для нахождения погрешностей

**основная задача теории погрешностей**: известны погрешности величин $x1\ldots x_n$, требуется найти погрешность заданной $f(x_1, \ldots, x_n)$ от этих величин

пусть задана дифференцируемая $f = f(x_1\ldots x_n)$ и известны $\Delta x_i$ - абсолютные погрешности агрументов. Тогда абсолютная погрешность функции 

$$\Delta f = |f(x_1 +\Delta x_1, \ldots, x_n + \Delta x_n) - f(x_1, \ldots, x_n)|$$
В силу малости $\Delta x_i$ можно записать так

$$\tag{1}\Delta f = \left| \sum_{i=1}^n\frac{\partial f}{\partial x_i}\Delta x_i\right|$$

$$\tag{2}\Delta f = \sum_{i=1}^n \left|\frac{\partial f}{\partial x_i}\right|\Delta x_i$$

(2) -- **общая формула для расчета погрешностей**

**обратная задача теории погрешностей**: каковы должны быть абсолютные погрешности агрументов функции, чтобы абсолютная погрешность функции не превышала заданной величины?

простейшее решение обратной задачи -- с использованием принципа равных влияний. согласно этому принципу предполагается, что все частные дифференциалы $\left |\frac {\partial f}{\partial x_i}\right |\Delta x_i$ вносят одинаковый вклад в абсолютную погрешность $\Delta f$ 

пусть $\Delta f$ задана, тогда 

$$\Delta f = \sum_{i=1}^n \left|\frac{\partial f}{\partial x_i}\right|\Delta x_i$$
$$\left|\frac{\partial f}{\partial x_1}\right|\Delta x_1=\left|\frac{\partial f}{\partial x_2}\right|\Delta x_2=\ldots=\left|\frac{\partial f}{\partial x_n}\right|\Delta x_n=\frac{\Delta f} f$$
$$\Delta x_i = \frac{\Delta f}{n\cdot \left|\frac{\partial f}{\partial x_i}\right|}$$

Формула (2) является приближенной, потому что там используются частные производные. Но если надо найти диапазон изменения функции в заданной точке, используется **метод границ** или и **метод двойных вычислений**, где, зная погрешности аргументов, можно точно указать диапазон изменения ф-ии

## Метод границ или метод двойных вычислений

Пусть $f(x_1, \ldots, x_n)$ непрерывна и монотонна по каждому аргументу. При этом сами аргументы находятся в диапазоне $x_{i_\min}\leq x_i\leq x_{i_\max}$

Тогда
$$ f(\underline x_1, \ldots, \underline x_n)\leq f\leq f(\overline x_1, \ldots, \overline x_n)$$
Слева - границы интервалов, где значения функции минимальны. Справа - границы интервалов, в которых функция максимальна. 

$$\Delta f_1 = \left|f(\overline x_1, \ldots, \overline x_n) - f(x_1, \ldots, x_n)\right|$$

$$\Delta f_2 = \left|f(x_1, \ldots, x_n) - f(\underline x_1, \ldots, \underline x_n)\right|$$
$$ f_0-\Delta f_2\leq f\leq f_0 + \Delta f_1$$
$$f = f_0\quad \begin{matrix}  + \Delta f_1; \quad \delta_1 = \frac{\Delta f_1}{f_0} \\ - \Delta f_2; \quad \delta_2 = \frac{\Delta f_2}{f_0}\end{matrix}$$

$$f = f_0\pm \Delta f;\quad \delta_1; \quad\text{if } \Delta f_1 = \Delta f_2$$

Здесь $f_0$ – значение функции в точке.

### Взаимосвязь относительных погрешностей приближенного числа с количеством верных цифр в записи числа 

Пусть дано $a = \alpha\cdot 10^{m-1}+\alpha_2\cdot 10^{m-2} + \ldots +\alpha_n \cdot 10^{m-n}\quad (\alpha_1\neq 0)$
Это число во всеми верными цифрами.

**Теорема**.. Если некоторое число $a$ имеет $n$ верных цифр, относительная погрешность этого числа $\delta$ не превышает величины

$$\delta\leq \frac 1{\alpha_1}\left(\frac 1{10}\right)^{n-1}$$

**Следствие 1**. За относительную погрешность числа $a$ можно принять величину, если в $a$ $n$ верных цифр.

$$\delta = \frac 1{\alpha_1}\left(\frac 1{10}\right)^{n-1}$$
**Следствие 2**. Если в записи числа 2 и больше верных цифр, то за относительную погрешность можно принять в 2 раза точнее

$$\delta = \frac 1{2\alpha_1}\left(\frac 1{10}\right)^{n-1}$$
В ДЗ можно аргументировать так: берём это приближение и эта величина должна быть ≤ заданного $\delta$, оттуда находим $n$.

### Полезная информация

| Количество верных цифр  |   Относительная погрешность  | Средняя величина    |
| --- | --- | --- |
|  1   | 5 - 50%    |   10%  |
|   2  |  0.5 - 5%   |  1%   |
|    3 | 0.05 - 0.5%    |  0.1%   |

## Правило определения верных значащих цифр в записи числа по абсолютной погрешности числа (по определению)

3 шага:
1. Берем 1, проверяем в разряде.
2. Делим её пополам
3. Сравниваем результат деления с абсолютной погрешностью. Если погрешности ≤ результату деления, то цифра в этом разряде является верной.

## Правило определения верных значащих цифр числа по заданной относительной погрешности

2 шага:
1. По формуле $\Delta = a\cdot \delta$ определяется величина абсолютной погрешности $\Delta$.
2. Применяется предыдущее правило для определения верных цифр числа по заданной абсолютной погрешности.

### Пример

результат = 25.4275 $\pm$ 0.0424

пишем с меньшим количеством цифр:
результат = 25.428 $\pm$ 0.043 (погрешность всегда округляется в большую сторону)

еще меньше цифр 
рез = 25.43 $\pm$ 0.05

---
$\Delta = 0.21$ округлить до одной значащей цифры → $\Delta = 0.3$

## Эмпирические формулы

Пусть выполнен эксперимент. Получен ряд значений $x_1\ldots x_n$ и $y_1\ldots y_n$.

Требуется найти эмпирическую формулу $y = f(x)$.

Построение этой формулы состоит из двух этапов.
1. Определение общего вида формулы (экспонента, степень, гипербола и тд)
2. Определение наилучших параметров формулы

Это **не задача интерполяции:** 
- Интерполяционный полином проходит точно по точкам, а эмпирическая формула – рядом с ними.
- эмпирическая формула, как правило, более проста
- она сглаживает местные погрешности; интерполяционный полином их, наоборот, собирает

### Замечание

При построении эмпирической формулы будем предполагать, что исходные данные эксперимента $x_i$ и $y_i$ положительны.

Но это не нарушает общность решения задачи:
- если $x_i < 0, y \geq 0$, мы можем уйти на работу с таблицей $(-x_i; y_i)$
- если наоборот, то работаем с $(x_i; -y_i)$
- если $x_i<0, y_i < 0$, то работаем с $(-x_i; y_i)$
- если они знакопеременны, то переходим к новым переменным
	- $\xi_i = m + x_i > 0$
	- $\eta_i = n + y_i > 0$ 
	- выбираем $m$ и $n$ в силу ограниченности таблицы
	- работаем с таблицей $(\xi_i, \eta_i)$

### Линейная зависимость

$$\begin{array}{c|c} x_i & x_1 & x_2 & x_3 & x_4 & \ldots \\\ y_i & y_1 & y_2 & y_3 & y_4 & \ldots\end{array}$$

Пусть мы считаем, что зависимость линейная (это наша гипотеза, и её надо проверить). Для этого эта таблица дополняется значениями 

$$\Delta x_i = x_{i+1} - x_i$$
$$\Delta y_i = y_{i+1} - y_i$$

$$\frac{\Delta x_i}{\Delta y_i}$$

Получаем

$$\begin{array}{c|c} x_i & x_1 & x_2 & x_3 & x_4 & \ldots \\\ y_i & y_1 & y_2 & y_3 & y_4 & \ldots\\\ \Delta x_i = x_{i+1} - x_i & \Delta x_1&\ldots\\\ \Delta y_i = y_{i+1} - y_i&\Delta y_1\\\ k_i = \frac{\Delta x_i}{\Delta y_i}&\frac{\Delta x_1}{\Delta y_2}\end{array}$$

Если оказывается, что $k_1\simeq k_2\simeq \ldots\simeq k_{n-1}$, то зависимость имеет линейный вид $y = kx + b$.

Если эксперимент выполнялся с постоянным шагом ($\Delta x_i = \text{const}$ ) то достаточно проверить $\Delta y_1 = \ldots = \Delta y_{n-1}$

### Степенная зависимость

Пусть гипотеза, такая, что $y = cx^a$, где
- $a, c$ – константы
- $c > 0$ (из предположения о том, что всё положительное)
- $x, y > 0$

логарифмируем:
$$y = cx^a$$

$$\lg y = a \lg x + \lg c$$

вводим новые переменные:

$$X = lg x\quad Y = \lg y$$
у новых переменных зависимость такая
$$Y = aX + b, \quad b = \lg c$$
мы пришли к тому, что чтобы исходная зависимость была степенная, надо, чтобы точки $N_i(\lg x_i, \lg y_i)$ лежали на одной прямой:

$$N = (\lg x_i, \lg y_i)$$

В соответствии с этим дополняем таблицу

$$\begin{array}{c|c} x_i & x_1 & x_2 & x_3 & x_4 & \ldots \\\ y_i & y_1 & y_2 & y_3 & y_4 & \ldots\\\ X = \lg x&\lg x_1\\\ Y = \lg y&\lg y_1\\\ \Delta X = \lg x_{i+1} - \lg x_i&\lg x_2 - \lg x_1\\\ \Delta Y = \lg y_{i+1} - \lg y_i \\\ \frac{\Delta Y}{\Delta X}\end{array}$$

Если $\frac{\Delta Y}{\Delta X}=\text{const}$, то исходная зависимость имеет вид $y = cx^a$.


### Показательная зависимость

Гипотеза: $y = ce^{ax}, \quad c>0$

Логарифмируем

$$\lg y = a_1 x + \lg c, \quad a_1 = a\lg e$$

вводим новые переменные

$$ X = x\quad Y = \lg y$$
в новых переменных зависимость принимает вид
$$ Y = a_1 X + b, \quad b = \lg c$$
чтобы исходная зависимость была показательная, нужно, чтобы точки $N_i(x_i, \lg y_i)$ лежали на одной прямой (это уже где-то было -_-)

дополняем таблицу

$$\begin{array}{c|c} x_i & x_1 & x_2 & x_3 & x_4 & \ldots \\\ y_i & y_1 & y_2 & y_3 & y_4 & \ldots\\\ Y = \lg y&\lg y_1\\\ \Delta X \\\ \Delta Y = \lg y_{i+1} - \lg y_i \\\ \frac{\Delta Y}{\Delta X}\end{array}$$

если $\frac {\Delta Y}{\Delta X} = \text{const}$, то это показательная зависимость

### Гиперболическая зависимость

гипотеза 
$$ y =\frac 1{ax + b}$$
$$ \frac 1y = ax + b$$
вводим новые переменные
$$ X = x\quad Y = \frac 1y$$
в них зависимость такая
$$ Y = aX + b$$
чтобы исходная зависимость была гиперболическая, нужно, чтобы точки $N_i(x_i, \frac 1{y_i})$ лежали на одной прямой

дополняем таблицу по аналогии с кейсами выше

$$\begin{array}{c|c} x_i & x_1 & x_2 & x_3 & x_4 & \ldots \\\ y_i & y_1 & y_2 & y_3 & y_4 & \ldots\\\ Y = \frac 1y&\frac 1{y_1}\\\ \Delta X \\\ \Delta Y \\\ \frac{\Delta Y}{\Delta X}\end{array}$$

если $\frac {\Delta Y}{\Delta X} \simeq \text{const}$, то это гиперболическая зависимость

### Квадратичная (параболическая) зависимость

гипотеза $y = ax^2 + bx + c\quad (a\neq 0)$

$$\tag 1 y = ax^2 + bx + c$$
- переносим эксперимент на плоскость (рисуем точки на графике)
- проводим плавную кривую $\Gamma$ вблизи экспериментальных точек и выбираем на этой кривой одну из точек $N(x_0, y_0)$, которая совпадает с некоторой экспериментальной точкой $M(x_k, y_k)$
- координаты этой точки будут удовлетворять параболе
$$\tag 2 y_0 = ax_0^2 + bx_0 + c$$

- вычитаем (1) - (2)

$$y - y_0 = a(x^2 - x_0^2)+b(x-x_0)$$
- дополняем до полного квадрата при $a$

$$y - y_0 = a(x - x_0)^2 + b_1(x - x_0), \quad b_1 = b + 2ax_0$$

- вводим новые переменные

$$X = x - x_0\quad Y = \frac{y - y_0}{x - x_0}$$

- тогда получаем зависимость

$$ Y = aX + b_1$$

если точки $N_i = (X_i, Y_i), X_i = x_i - x_0; Y_i = \frac{y_i - y_0}{x_i - x_0}$ лежат на одной прямой, то исходные точки лежат на параболе


### Определение параметров эмпирической формулы

если выбран общий вид формулы $y = \overline f(x; a_1, \ldots, a_m)$, то следующим шагом является нахождение наилучших параметров $a_i$

есть три метода для этого
- метод выбранных точек
- метод средних
- метод наименьших квадратов









